<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíï ÎèôÎ£åÎì§Ïù¥ Î≥¥Îäî ÎÇòÏùò ÏßÑÏßú Î™®Ïäµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 10;
        }

        .header {
            text-align: center;
            padding: 40px 30px 30px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .title {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .subtitle {
            color: #666;
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 25px;
        }

        .content {
            padding: 30px;
        }

        .setup-section, .survey-section, .result-section {
            display: none;
        }

        .setup-section.active, .survey-section.active, .result-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ff;
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: #f8faff;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }

        .btn {
            width: 100%;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn.secondary {
            background: #f3f4f6;
            color: #374151;
            border: 2px solid #e5e7eb;
        }

        .btn.secondary:hover {
            background: #e5e7eb;
        }

        .question-container {
            margin-bottom: 30px;
        }

        .question {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.5;
            text-align: center;
        }

        .options {
            display: grid;
            gap: 12px;
        }

        .option {
            background: #f8faff;
            border: 2px solid #e1e8ff;
            border-radius: 12px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            line-height: 1.4;
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .option:hover::before {
            left: 100%;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f3ff;
            transform: translateY(-2px);
        }

        .option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: scale(1.02);
        }

        .option-emoji {
            font-size: 1.5rem;
            margin-right: 12px;
            display: inline-block;
            vertical-align: middle;
        }

        .option-text {
            display: inline-block;
            vertical-align: middle;
            max-width: calc(100% - 2.5rem);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e8ff;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .result-card {
            background: #f8faff;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e1e8ff;
        }

        .result-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.3;
        }

        .result-description {
            color: #555;
            line-height: 1.8;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1rem;
        }

        .trait-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .trait-info {
            flex: 1;
        }

        .trait-name {
            font-weight: 700;
            color: #333;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        .trait-desc {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.4;
        }

        .trait-percentage {
            font-weight: 700;
            color: #667eea;
            font-size: 1.2rem;
            margin-left: 15px;
        }

        .share-section {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e1e8ff;
        }

        .share-text {
            color: #666;
            margin-bottom: 15px;
            font-weight: 600;
            line-height: 1.6;
        }

        .share-link {
            background: #f8faff;
            border: 2px solid #e1e8ff;
            border-radius: 12px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.9rem;
            margin-bottom: 15px;
            word-break: break-all;
            color: #667eea;
        }

        .encouragement {
            background: linear-gradient(135deg, #fff8f0, #fef7ff);
            border: 1px solid #fde5ff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            color: #8b5a3c;
            font-size: 0.95rem;
            line-height: 1.7;
            text-align: center;
        }

        .encouragement strong {
            color: #667eea;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 12px;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .survey-intro {
            text-align: center;
            margin-bottom: 30px;
        }

        .target-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .survey-desc {
            color: #666;
            line-height: 1.6;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 20px;
            }
            
            .header {
                padding: 30px 25px 25px;
            }
            
            .content {
                padding: 25px;
            }
            
            .title {
                font-size: 1.7rem;
            }

            .option {
                padding: 15px;
            }

            .trait-result {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .trait-percentage {
                margin-left: 0;
                align-self: flex-end;
            }
        }

        .floating-emoji {
            position: fixed;
            font-size: 2rem;
            opacity: 0.4;
            pointer-events: none;
            z-index: 1;
            animation: float 8s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg);
                opacity: 0.3;
            }
            50% { 
                transform: translateY(-20px) rotate(10deg);
                opacity: 0.6;
            }
        }

        .welcome-screen {
            text-align: center;
        }

        .loading-animation {
            display: none;
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 1.2rem;
        }

        .loading-dots {
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <!-- Îñ†Îã§ÎãàÎäî Ïù¥Î™®ÏßÄÎì§ -->
    <div class="floating-emoji" style="top: 10%; left: 10%; animation-delay: 0s;">üíï</div>
    <div class="floating-emoji" style="top: 20%; right: 15%; animation-delay: 2s;">‚ú®</div>
    <div class="floating-emoji" style="bottom: 30%; left: 20%; animation-delay: 4s;">ü•∞</div>
    <div class="floating-emoji" style="bottom: 20%; right: 10%; animation-delay: 6s;">üí´</div>
    <div class="floating-emoji" style="top: 50%; left: 5%; animation-delay: 1s;">üåü</div>

    <div class="container">
        <div class="header">
            <h1 class="title">üíï ÎèôÎ£åÎì§Ïù¥ Î≥¥Îäî ÎÇò</h1>
            <p class="subtitle">
                <strong>ÏßÑÏßú ÏÜåÏ§ëÌïú ÎãπÏã†ÏùÑ ÏúÑÌïú ÌäπÎ≥ÑÌïú ÏãúÍ∞Ñ</strong> ‚ú®<br>
                ÎèôÎ£åÎì§Ïùò Îî∞ÎúªÌïú ÏãúÏÑ†ÏúºÎ°ú Î∞úÍ≤¨ÌïòÎäî<br>
                ÎÇòÏùò Ïà®Í≤®ÏßÑ Îß§Î†•Í≥º ÎπõÎÇòÎäî Î™®ÏäµÎì§ üíé
            </p>
        </div>

        <div class="content">
            <!-- Ï¥àÍ∏∞ ÏÑ§Ï†ï ÌôîÎ©¥ -->
            <div class="setup-section active">
                <div class="welcome-screen">
                    <div class="encouragement">
                        üí´ <strong>ÎãπÏã†ÏùÄ Ïù¥ÎØ∏ Ï∂©Î∂ÑÌûà ÌäπÎ≥ÑÌïòÍ≥† ÏÜåÏ§ëÌïú Ï°¥Ïû¨ÏòàÏöî!</strong><br>
                        ÎèôÎ£åÎì§Ïùò ÏãúÏÑ†ÏóêÏÑú Î∞úÍ≤¨Îê†<br>
                        ÎãπÏã†Ïùò Î∞òÏßùÏù¥Îäî Î™®ÏäµÎì§Ïù¥ Ï†ïÎßê Í∏∞ÎåÄÎèºÏöî ‚ú®
                    </div>
                    
                    <div class="form-group">
                        <label for="userName">üåü ÎÇ¥ ÎãâÎÑ§ÏûÑ (Ïã§Î™ÖÎèÑ Í¥úÏ∞ÆÏïÑÏöî!)</label>
                        <input type="text" id="userName" placeholder="Ïòà: Í∑ÄÏó¨Ïö¥ ÍπÄÎòêÎ¶¨, ÍπÄÎØºÏàò, Î∞ùÏùÄÏóêÎÑàÏßÄ Îì±">
                    </div>
                    
                    <button class="btn" onclick="createSurvey()">üöÄ ÎÇ¥ Ï†ÑÏö© ÎßÅÌÅ¨ ÎßåÎì§Í∏∞</button>
                    
                    <div class="encouragement">
                        üí° <strong>ÎßÅÌÅ¨Î•º ÎßåÎì§Î©¥ ÎèôÎ£åÎì§Ïù¥ ÌÅ¥Î¶≠ Ìïú Î≤àÏúºÎ°ú<br>
                        Î∞îÎ°ú ÎãπÏã†Ïóê ÎåÄÌïú ÏÑ§Î¨∏Ïóê Ï∞∏Ïó¨Ìï† Ïàò ÏûàÏñ¥Ïöî!</strong><br>
                        Ïπ¥ÌÜ°Ïù¥ÎÇò Ïä¨ÎûôÏúºÎ°ú ÎßÅÌÅ¨Îßå Î≥¥ÎÇ¥Î©¥ ÎÅù! üéØ
                    </div>
                </div>
            </div>

            <!-- ÏÑ§Î¨∏ Ï∞∏Ïó¨ ÌôîÎ©¥ -->
            <div class="survey-section">
                <div class="survey-intro">
                    <div class="target-name" id="targetName"></div>
                    <div class="survey-desc">
                        <strong>Ïù¥ ÏÜåÏ§ëÌïú Î∂ÑÏóê ÎåÄÌï¥<br>
                        ÎãπÏã†Ïù¥ ÎäêÎÅºÎäî ÏÜîÏßÅÌïú ÏÉùÍ∞ÅÏùÑ Îì§Î†§Ï£ºÏÑ∏Ïöî!</strong> üíï<br>
                        ÎãπÏã†Ïùò Îî∞ÎúªÌïú ÏãúÏÑ†Ïù¥<br>
                        ÎàÑÍµ∞Í∞ÄÏóêÍ≤åÎäî ÌÅ∞ ÌûòÏù¥ Îê† Í±∞ÏòàÏöî ‚ú®
                    </div>
                </div>
                
                <div class="progress-text" id="progressText">1/8 ÏßàÎ¨∏</div>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                
                <div class="question-container">
                    <div class="question" id="currentQuestion"></div>
                    <div class="options" id="optionsContainer"></div>
                </div>

                <div class="loading-animation" id="loadingAnimation">
                    <div class="loading-dots">ÎãµÎ≥ÄÏùÑ Ï†ÄÏû•ÌïòÍ≥† ÏûàÏñ¥Ïöî... ‚ú®</div>
                </div>
            </div>

            <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
            <div class="result-section">
                <div class="stats" id="surveyStats"></div>
                
                <div class="result-card">
                    <div class="result-title">‚ú® ÎèôÎ£åÎì§Ïù¥ Î∞úÍ≤¨Ìïú<br>ÎÇòÏùò ÎπõÎÇòÎäî Î™®ÏäµÎì§</div>
                    <div class="result-description" id="resultDescription"></div>
                    <div id="resultContent"></div>
                </div>
                
                <div class="share-section">
                    <p class="share-text">
                        üîó <strong>Îçî ÎßéÏùÄ ÎèôÎ£åÎì§ÏóêÍ≤å<br>ÏÇ¨ÎûëÎ∞õÎäî ÎÇ¥ Î™®Ïäµ Î∞úÍ≤¨ÌïòÍ∏∞</strong><br>
                        ÏïÑÎûò ÎßÅÌÅ¨Î•º Í≥µÏú†Ìï¥ÏÑú<br>
                        Îçî ÎßéÏùÄ Îî∞ÎúªÌïú ÏãúÏÑ†Îì§ÏùÑ Î™®ÏïÑÎ≥¥ÏÑ∏Ïöî! üíù
                    </p>
                    <div class="share-link" id="shareLink"></div>
                    <button class="btn secondary" onclick="copyLink()">üìã ÎßÅÌÅ¨ Î≥µÏÇ¨Ìï¥ÏÑú Í≥µÏú†ÌïòÍ∏∞</button>
                    <button class="btn" onclick="createNewSurvey()">üÜï ÏÉàÎ°úÏö¥ Îß§Î†• Î∞úÍµ¥ÌïòÍ∏∞</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // MZÍ∞êÏÑ± ÎÑòÏπòÎäî Ïû¨ÎØ∏ÏûàÎäî ÏÑ§Î¨∏ ÏßàÎ¨∏Îì§
        const questions = [
            {
                text: "üåÖ Ï≤´ Ï∂úÍ∑ºÌï† ÎïåÎ∂ÄÌÑ∞ ÏßÄÍ∏àÍπåÏßÄ,<br>Ïù¥ ÏÇ¨ÎûåÏùò Ïò§ÎùºÎäî?",
                options: [
                    { emoji: "‚òÄÔ∏è", text: "365Ïùº ÎπÑÌÉÄÎØºD ÌíÄÏ∂©Ï†Ñ ÌñáÏÇ¥ Ïù∏Í∞Ñ", trait: "sunshine" },
                    { emoji: "üåô", text: "Ï∞®Î∂ÑÌïòÍ≥† Ïã†ÎπÑÎ°úÏö¥ Îã¨Îπõ Í∞êÏÑ±", trait: "mysterious" },
                    { emoji: "‚ö°", text: "ÏóêÎÑàÏßÄ ÎìúÎßÅÌÅ¨ Ï≤¥Ïßà Î≤àÍ∞úÎß®", trait: "energetic" },
                    { emoji: "üå∏", text: "Î≥¥Í∏∞Îßå Ìï¥ÎèÑ Í∏∞Î∂Ñ Ï¢ãÏïÑÏßÄÎäî Î≤öÍΩÉ ÏóîÎî©", trait: "healing" }
                ]
            },
            {
                text: "üíº ÏóÖÎ¨¥ Ïä§ÌÉÄÏùºÏùÑ<br>ÎèôÎ¨ºÎ°ú ÎπÑÏú†ÌïòÎ©¥?",
                options: [
                    { emoji: "üêÜ", text: "ÏπòÌÉÄÏ≤òÎüº Îπ†Î•¥Í≥† Ï†ïÌôïÌïú Ïä§ÌîºÎìúÎü¨ÎÑà", trait: "speedy" },
                    { emoji: "ü¶â", text: "Ïò¨ÎπºÎØ∏Ï≤òÎüº ÍººÍººÌïòÍ≥† ÌòÑÎ™ÖÌïú Ï†ÑÎûµÍ∞Ä", trait: "wise" },
                    { emoji: "üêù", text: "ÍøÄÎ≤åÏ≤òÎüº Î∂ÄÏßÄÎü∞ÌïòÍ≥† ÌòëÎèôÏ†ÅÏù∏ ÌåÄÌîåÎ†àÏù¥Ïñ¥", trait: "teamwork" },
                    { emoji: "ü¶ã", text: "ÎÇòÎπÑÏ≤òÎüº Ï∞ΩÏùòÏ†ÅÏù¥Í≥† ÏïÑÎ¶ÑÎã§Ïö¥ ÏïÑÏù¥ÎîîÏñ¥ Î©îÏù¥Ïª§", trait: "creative" }
                ]
            },
            {
                text: "üó£Ô∏è ÌöåÏùòÌï† Îïå<br>Ïù¥ ÏÇ¨ÎûåÏùò Ìè¨ÏßÄÏÖòÏùÄ?",
                options: [
                    { emoji: "üé§", text: "ÎßàÏù¥ÌÅ¨ Ïû°ÏúºÎ©¥ TED ÌÜ†ÌÅ¨ Í∏â Î∞úÌëúÎ†•", trait: "presenter" },
                    { emoji: "üß†", text: "Ìïú ÎßàÎîî ÌïòÎ©¥ Î™®ÎëêÍ∞Ä 'ÏïÑÌïò!' ÌïòÎäî Ïù∏ÏÇ¨Ïù¥Ìä∏ ÌÇπ", trait: "insightful" },
                    { emoji: "üòå", text: "Î∂ÑÏúÑÍ∏∞ ÏùΩÍ≥† Ï†ÅÏû¨Ï†ÅÏÜåÏóê ÌÉÄÏù¥Î∞ç Í∞ë", trait: "tactful" },
                    { emoji: "üëÇ", text: "Í≤ΩÏ≤≠Ïùò Îã¨Ïù∏, Î™®Îì† ÎßêÏùÑ Îã§ Î∞õÏïÑÏ£ºÎäî Îì†Îì†Ìïú ÏïµÏª§", trait: "listener" }
                ]
            },
            {
                text: "‚òï Ï†êÏã¨ÏãúÍ∞Ñ or Ïâ¨Îäî ÏãúÍ∞ÑÏùò<br>Ïù¥ ÏÇ¨ÎûåÏùÄ?",
                options: [
                    { emoji: "üé™", text: "Ïñ¥ÎîîÏÑúÎì† ÏõÉÏùå ÍΩÉÏù¥ ÌîºÎäî Î∂ÑÏúÑÍ∏∞ Î©îÏù¥Ïª§", trait: "entertainer" },
                    { emoji: "üì±", text: "ÏÜåÏÜåÌïú ÏùºÏÉÅ TMIÎ°ú Ïû¨ÎØ∏Î•º Ï£ºÎäî Ïä§ÌÜ†Î¶¨ÌÖîÎü¨", trait: "storyteller" },
                    { emoji: "üßò‚Äç‚ôÄÔ∏è", text: "ÌòºÏûêÎßåÏùò ÏãúÍ∞ÑÏúºÎ°ú ÏóêÎÑàÏßÄ Ï∂©Ï†ÑÌïòÎäî ÌûêÎü¨", trait: "recharger" },
                    { emoji: "ü§ó", text: "ÎàÑÍµ¨Îì† Ìé∏ÌïòÍ≤å Îã§Í∞ÄÍ∞à Ïàò ÏûàÎäî Ïù∏Í∞Ñ Ïπ¥Ìéò", trait: "approachable" }
                ]
            },
            {
                text: "üí• Í∞ëÏûëÏä§Îü¨Ïö¥ Î≥ÄÏàòÍ∞Ä<br>ÏÉùÍ≤ºÏùÑ Îïå?",
                options: [
                    { emoji: "üèÉ‚Äç‚ôÄÔ∏è", text: "1Ï¥à ÎßåÏóê ÌîåÎûúB Í∫ºÎÇ¥Îäî ÎßåÎä• Ìï¥Í≤∞ÏÇ¨", trait: "flexible" },
                    { emoji: "üßÆ", text: "Ï∞®Í∑ºÏ∞®Í∑º Î∂ÑÏÑùÌïòÍ≥† ÏôÑÎ≤ΩÌïú Ìï¥Îãµ Ï†úÏãúÌïòÎäî Ï†ÑÎûµÍ∞Ä", trait: "analytical" },
                    { emoji: "ü§ù", text: "ÌåÄÏõêÎì§ Ï±ôÍ∏∞Î©¥ÏÑú Ìï®Íªò Ìó§Ï≥êÎÇòÍ∞ÄÎäî Î¶¨ÎçîÏâΩ", trait: "caring" },
                    { emoji: "üßä", text: "Ïñ¥Îñ§ ÏÉÅÌô©ÏóêÎèÑ ÌùîÎì§Î¶¨ÏßÄ ÏïäÎäî Î©òÌÉà Í∞ë of Í∞ë", trait: "stable" }
                ]
            },
            {
                text: "üåü ÎèôÎ£åÎì§Ïù¥ ÌûòÎì§ Îïå<br>Ïù¥ ÏÇ¨ÎûåÏù¥ Ìï¥Ï£ºÎäî Ïó≠Ìï†ÏùÄ?",
                options: [
                    { emoji: "üî•", text: "Îã§Ïãú ÏùºÏñ¥ÏÑ§ Ïàò ÏûàÎäî Ïö©Í∏∞Î•º Ï£ºÎäî ÎèôÍ∏∞Î∂ÄÏó¨ ÎßàÏä§ÌÑ∞", trait: "motivator" },
                    { emoji: "ü§ó", text: "Îî∞ÎúªÌïú ÏúÑÎ°úÎ°ú ÎßàÏùåÏùÑ Ïñ¥Î£®ÎßåÏ†∏Ï£ºÎäî ÌûêÎßÅ ÏöîÏ†ï", trait: "comforter" },
                    { emoji: "üí°", text: "Ïã§ÏßàÏ†ÅÏù∏ Ìï¥Í≤∞Ï±ÖÏùÑ Ï∞æÏïÑÏ£ºÎäî Î¨∏Ï†úÌï¥Í≤∞ Ï≤úÏû¨", trait: "problemsolver" },
                    { emoji: "üòÑ", text: "ÏõÉÏùåÏúºÎ°ú Ïä§Ìä∏Î†àÏä§Î•º ÎÇ†Î†§Î≤ÑÎ¶¨Îäî Í∞úÍ∑∏Îß®", trait: "comedian" }
                ]
            },
            {
                text: "üéØ Ïù¥ ÏÇ¨ÎûåÏùò<br>Í∞ÄÏû• ÌÇ¨ÎßÅ Ìè¨Ïù∏Ìä∏Îäî?",
                options: [
                    { emoji: "üíé", text: "ÎØøÍ≥† Îß°Í∏∏ Ïàò ÏûàÎäî Ïã†Î¢∞ÎèÑ MAX Ïù∏Í∞Ñ", trait: "trustworthy" },
                    { emoji: "üé®", text: "ÏÉùÍ∞ÅÏßÄÎèÑ Î™ªÌïú Ï∞∏Ïã†Ìïú ÏïÑÏù¥ÎîîÏñ¥Î°ú ÎÜÄÎùºÍ≤å ÌïòÎäî ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞", trait: "innovative" },
                    { emoji: "‚ù§Ô∏è", text: "ÏßÑÏã¨Ïù¥ ÎäêÍª¥ÏßÄÎäî Îî∞ÎúªÌïú ÎßàÏùåÏùò ÏÜåÏú†Ïûê", trait: "warmhearted" },
                    { emoji: "üî•", text: "Ïó¥Ï†ïÏù¥ Ï†ÑÏóºÎêòÎäî ÏóêÎÑàÏßÄ Î∞îÏù¥Îü¨Ïä§", trait: "passionate" }
                ]
            },
            {
                text: "üí´ Ìïú Ï§ÑÎ°ú Ï†ïÏùòÌïòÎäî<br>Ïù¥ ÏÇ¨ÎûåÏùÄ?",
                options: [
                    { emoji: "üèÜ", text: "Í∞ôÏùÄ ÌåÄÏù¥ÎùºÏÑú Îã§ÌñâÏù¥Îã§ Ïã∂ÏùÄ Îì†Îì†Ìïú ÎèôÎ∞òÏûê", trait: "reliable" },
                    { emoji: "üåà", text: "ÏûàÎäî Í≤ÉÎßåÏúºÎ°úÎèÑ Ï£ºÎ≥ÄÏù¥ Î∞ùÏïÑÏßÄÎäî ÌñâÏö¥Ïùò ÏöîÏ†ï", trait: "lucky" },
                    { emoji: "üßô‚Äç‚ôÄÔ∏è", text: "Î∂àÍ∞ÄÎä•ÏùÑ Í∞ÄÎä•ÏúºÎ°ú ÎßåÎìúÎäî ÏóÖÎ¨¥ ÎßàÎ≤ïÏÇ¨", trait: "magical" },
                    { emoji: "üíù", text: "ÎßåÎÇòÏÑú Ï†ïÎßê Îã§ÌñâÏù¥ÎùºÎäî ÏÉùÍ∞ÅÏù¥ ÎìúÎäî ÏÜåÏ§ëÌïú ÏÇ¨Îûå", trait: "precious" }
                ]
            }
        ];

        // ÌäπÏÑ±Î≥Ñ Îî∞ÎúªÌïú ÏÑ§Î™Ö
        const traitDescriptions = {
            sunshine: { name: "ÌñáÏÇ¥ ÎπÑÌÉÄÎØº", desc: "ÎãπÏã†Ïù¥ ÏûàÎäî Í≥≥ÏùÄ Ïñ∏Ï†úÎÇò Îî∞ÎúªÌïòÍ≥† Î∞ùÏïÑÏöî" },
            mysterious: { name: "Îã¨Îπõ Í∞êÏÑ±", desc: "Ïã†ÎπÑÎ°úÏö∞Î©¥ÏÑúÎèÑ Ï∞®Î∂ÑÌïú Îß§Î†•Ïùò ÏÜåÏú†Ïûê" },
            energetic: { name: "ÏóêÎÑàÏßÄ Ï∂©Ï†ÑÍ∏∞", desc: "ÎãπÏã†Ïùò ÏóêÎÑàÏßÄÍ∞Ä Î™®ÎëêÏóêÍ≤å Ï†ÑÌï¥Ï†∏Ïöî" },
            healing: { name: "ÌûêÎßÅ ÏöîÏ†ï", desc: "Î≥¥Í∏∞Îßå Ìï¥ÎèÑ ÎßàÏùåÏù¥ Ìé∏ÏïàÌï¥ÏßÄÎäî Ï°¥Ïû¨" },
            speedy: { name: "Ïä§ÌîºÎìú ÎßàÏä§ÌÑ∞", desc: "Îπ†Î•¥Î©¥ÏÑúÎèÑ Ï†ïÌôïÌïú ÎãπÏã†Ïùò Îä•Î†•Ïóê Í∞êÌÉÑÌï¥Ïöî" },
            wise: { name: "ÏßÄÌòúÏùò ÌòÑÏûê", desc: "ÍπäÏù¥ ÏûàÎäî ÏÇ¨Í≥†Î°ú Î™®ÎëêÎ•º Ïù¥ÎÅÑÎäî Î¶¨Îçî" },
            teamwork: { name: "ÌòëÏóÖ Îã¨Ïù∏", desc: "Ìï®Íªò ÏùºÌï† Îïå ÏßÑÍ∞ÄÎ•º Î∞úÌúòÌïòÎäî ÌåÄÌîåÎ†àÏù¥Ïñ¥" },
            creative: { name: "Ï∞ΩÏùòÎ†• Ìè≠Î∞ú", desc: "ÏïÑÎ¶ÑÎã§Ïö¥ ÏïÑÏù¥ÎîîÏñ¥Î°ú Î™®ÎëêÎ•º ÎÜÄÎùºÍ≤å Ìï¥Ïöî" },
            presenter: { name: "Î∞úÌëú Ï≤úÏû¨", desc: "ÎãπÏã†Ïùò Î∞úÌëúÎäî Ïñ∏Ï†úÎÇò Ïù∏ÏÉÅ ÍπäÏñ¥Ïöî" },
            insightful: { name: "Ïù∏ÏÇ¨Ïù¥Ìä∏ ÌÇπ", desc: "ÌïµÏã¨ÏùÑ Ï∞åÎ•¥Îäî ÌÜµÏ∞∞Î†•Ïùò ÏÜåÏú†Ïûê" },
            tactful: { name: "ÏÑºÏä§ ÎßåÏ†ê", desc: "ÏôÑÎ≤ΩÌïú ÌÉÄÏù¥Î∞çÏúºÎ°ú Î∂ÑÏúÑÍ∏∞Î•º ÏùΩÏñ¥ÎÇ¥Ïöî" },
            listener: { name: "Í≤ΩÏ≤≠Ïùò Îã¨Ïù∏", desc: "Î™®Îì† Ïù¥ÏïºÍ∏∞Î•º Îî∞ÎúªÌïòÍ≤å Îì§Ïñ¥Ï£ºÎäî ÏÇ¨Îûå" },
            entertainer: { name: "Î∂ÑÏúÑÍ∏∞ Î©îÏù¥Ïª§", desc: "ÎãπÏã† ÎçïÎ∂ÑÏóê ÌöåÏÇ¨Í∞Ä Ï¶êÍ±∞ÏõåÏ†∏Ïöî" },
            storyteller: { name: "Ïä§ÌÜ†Î¶¨ÌÖîÎü¨", desc: "Ïû¨ÎØ∏ÏûàÎäî Ïù¥ÏïºÍ∏∞Î°ú Î™®ÎëêÎ•º ÏõÉÍ≤å ÎßåÎì§Ïñ¥Ïöî" },
            recharger: { name: "ÏóêÎÑàÏßÄ Ï∂©Ï†Ñ ÎßàÏä§ÌÑ∞", desc: "ÌòºÏûêÎßåÏùò ÏãúÍ∞ÑÎèÑ ÏÜåÏ§ëÌûà Ïó¨Í∏∞Îäî ÏßÄÌòú" },
            approachable: { name: "Ïù∏Í∞Ñ Ïπ¥Ìéò", desc: "ÎàÑÍµ¨ÎÇò Ìé∏ÌïòÍ≤å Îã§Í∞ÄÍ∞à Ïàò ÏûàÎäî Îî∞ÎúªÌï®" },
            flexible: { name: "ÎßåÎä• Ìï¥Í≤∞ÏÇ¨", desc: "Ïñ¥Îñ§ ÏÉÅÌô©ÏóêÎèÑ Ïú†Ïó∞ÌïòÍ≤å ÎåÄÏ≤òÌïòÎäî Îä•Î†•Ïûê" },
            analytical: { name: "Î∂ÑÏÑùÏùò Îã¨Ïù∏", desc: "Ï≤¥Í≥ÑÏ†ÅÏù∏ ÏÇ¨Í≥†Î°ú ÏôÑÎ≤ΩÌïú Ìï¥ÎãµÏùÑ Ï∞æÏïÑÎÇ¥Ïöî" },
            caring: { name: "Î∞∞Î†§ ÍπäÏùÄ Î¶¨Îçî", desc: "Î™®ÎëêÎ•º Ï±ôÍ∏∞Î©∞ Ìï®Íªò ÎÇòÏïÑÍ∞ÄÎäî ÏßÑÏ†ïÌïú Î¶¨Îçî" },
            stable: { name: "Î©òÌÉà Í∞ë", desc: "ÌùîÎì§Î¶¨ÏßÄ ÏïäÎäî ÏïàÏ†ïÍ∞êÏúºÎ°ú Î™®ÎëêÏùò Îì†Îì†Ìïú Î≤ÑÌåÄÎ™©" },
            motivator: { name: "ÎèôÍ∏∞Î∂ÄÏó¨ ÎßàÏä§ÌÑ∞", desc: "ÎãπÏã†Ïùò Îßê ÌïúÎßàÎîîÍ∞Ä ÌÅ∞ ÌûòÏù¥ ÎêòÏñ¥Ïöî" },
            comforter: { name: "ÌûêÎßÅ ÏöîÏ†ï", desc: "Îî∞ÎúªÌïú ÏúÑÎ°úÎ°ú ÏÉÅÏ≤òÎ∞õÏùÄ ÎßàÏùåÏùÑ ÏπòÏú†Ìï¥Ï§òÏöî" },
            problemsolver: { name: "Î¨∏Ï†úÌï¥Í≤∞ Ï≤úÏû¨", desc: "Ïñ¥Î†§Ïö¥ Î¨∏Ï†úÎèÑ Ï≤ôÏ≤ô Ìï¥Í≤∞ÌïòÎäî Îä•Î†•Ïûê" },
            comedian: { name: "ÏõÉÏùå Ï†úÏ°∞Í∏∞", desc: "ÏõÉÏùåÏúºÎ°ú Î™®Îì† Ïä§Ìä∏Î†àÏä§Î•º ÎÇ†Î†§Î≤ÑÎ†§Ïöî" },
            trustworthy: { name: "Ïã†Î¢∞ÎèÑ MAX", desc: "ÎãπÏã†ÎßåÌÅº ÎØøÏùÑ ÎßåÌïú ÏÇ¨ÎûåÏùÑ Ï∞æÍ∏∞ Ïñ¥Î†§ÏõåÏöî" },
            innovative: { name: "ÏïÑÏù¥ÎîîÏñ¥ ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞", desc: "Ï∞∏Ïã†Ìïú Î∞úÏÉÅÏúºÎ°ú Î™®ÎëêÎ•º ÎÜÄÎùºÍ≤å Ìï¥Ïöî" },
            warmhearted: { name: "Îî∞ÎúªÌïú ÎßàÏùå", desc: "ÏßÑÏã¨Ïù¥ ÎäêÍª¥ÏßÄÎäî ÎãπÏã†Ïùò ÎßàÏùåÏù¥ ÏÜåÏ§ëÌï¥Ïöî" },
            passionate: { name: "Ïó¥Ï†ï Î∞îÏù¥Îü¨Ïä§", desc: "ÎãπÏã†Ïùò Ïó¥Ï†ïÏù¥ Î™®ÎëêÏóêÍ≤å Ï†ÑÏóºÎêòÏñ¥Ïöî" },
            reliable: { name: "Îì†Îì†Ìïú ÎèôÎ∞òÏûê", desc: "Í∞ôÏùÄ ÌåÄÏù¥ÎùºÏÑú Ï†ïÎßê Îã§ÌñâÏù¥ÏóêÏöî" },
            lucky: { name: "ÌñâÏö¥Ïùò ÏöîÏ†ï", desc: "ÎãπÏã†Ïù¥ ÏûàÏúºÎ©¥ Î™®Îì† ÏùºÏù¥ Ïûò ÌíÄÎ†§Ïöî" },
            magical: { name: "ÏóÖÎ¨¥ ÎßàÎ≤ïÏÇ¨", desc: "Î∂àÍ∞ÄÎä•ÏùÑ Í∞ÄÎä•ÏúºÎ°ú ÎßåÎìúÎäî ÎßàÎ≤ï Í∞ôÏùÄ Îä•Î†•" },
            precious: { name: "ÏÜåÏ§ëÌïú Î≥¥Î¨º", desc: "ÎßåÎÇòÏÑú Ï†ïÎßê Îã§ÌñâÏù∏ ÌäπÎ≥ÑÌïú ÏÇ¨Îûå" }
        };

        // Í≤©Î†§ Î©îÏãúÏßÄÎì§
        const encouragementMessages = [
            "üíï ÎèôÎ£åÎì§Ïù¥ ÎãπÏã†ÏùÑ Ïù¥Î†áÍ≤å ÏÉùÍ∞ÅÌïòÍ≥† ÏûàÏóàÎã§Îãà!<br>Ï†ïÎßê ÏÇ¨ÎûëÏä§ÎüΩÍ≥† ÌäπÎ≥ÑÌïú Ï°¥Ïû¨ÏãúÎÑ§Ïöî ‚ú®",
            "üåü Ïù¥ Í≤∞Í≥ºÎ•º Î≥¥Îãà ÎãπÏã†Ïù¥ ÏñºÎßàÎÇò ÏÜåÏ§ëÌïú ÏÇ¨ÎûåÏù∏ÏßÄ<br>Îã§Ïãú ÌïúÎ≤à ÎäêÎÅºÍ≤å ÎêòÏñ¥Ïöî üíé",
            "‚ú® ÎèôÎ£åÎì§Ïùò Îî∞ÎúªÌïú ÏãúÏÑ†ÏóêÏÑú Î∞úÍ≤¨Îêú<br>ÎãπÏã†Ïùò ÎπõÎÇòÎäî Î™®ÏäµÎì§Ïù¥ Ï†ïÎßê ÏïÑÎ¶ÑÎã§ÏõåÏöî üåà",
            "üí´ Ïù¥Îü∞ ÌèâÍ∞ÄÎ•º Î∞õÎäîÎã§Îäî Í±¥<br>ÎãπÏã†Ïù¥ ÏñºÎßàÎÇò Î©ãÏßÑ ÏÇ¨ÎûåÏù∏ÏßÄ Î≥¥Ïó¨Ï£ºÎäî Í±∞ÏòàÏöî! üèÜ"
        ];

        // Ïï± ÏÉÅÌÉú
        let currentSurvey = null;
        let currentQuestionIndex = 0;
        let answers = [];
        let surveys = {}; // Î©îÎ™®Î¶¨Ïóê Ï†ÄÏû•

        // URL ÌååÎùºÎØ∏ÌÑ∞ÏóêÏÑú ÏÇ¨Ïö©Ïûê Ïù¥Î¶Ñ Ï∂îÏ∂ú
        function getUserFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('user');
        }

        // Í≥†Ïú† ID ÏÉùÏÑ± Ìï®Ïàò
        function generateSurveyId(userName) {
            return btoa(encodeURIComponent(userName)).replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
        }

        // ÏÑ§Î¨∏ ÏÉùÏÑ±
        function createSurvey() {
            const userName = document.getElementById('userName').value.trim();
            
            if (!userName) {
                alert('ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî! üòä');
                return;
            }
            
            const surveyId = generateSurveyId(userName);
            
            // ÏÑ§Î¨∏ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            surveys[surveyId] = {
                name: userName,
                responses: [],
                traits: {},
                createdAt: new Date().toISOString()
            };
            
            // Í≤∞Í≥º ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
            showResults(surveyId, userName);
        }

        // ÏÑ§Î¨∏ ÏãúÏûë (URLÏóêÏÑú ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÏù¥ ÏûàÏùÑ Îïå)
        function startSurveyFromUrl() {
            const userName = getUserFromUrl();
            if (!userName) return;
            
            const surveyId = generateSurveyId(userName);
            
            // Ìï¥Îãπ ÏÑ§Î¨∏Ïù¥ ÏóÜÏúºÎ©¥ ÏÉùÏÑ±
            if (!surveys[surveyId]) {
                surveys[surveyId] = {
                    name: userName,
                    responses: [],
                    traits: {},
                    createdAt: new Date().toISOString()
                };
            }
            
            currentSurvey = surveyId;
            currentQuestionIndex = 0;
            answers = [];
            
            // ÏÑ§Î¨∏ ÌôîÎ©¥ ÌëúÏãú
            document.querySelector('.setup-section').style.display = 'none';
            document.querySelector('.survey-section').classList.add('active');
            
            // ÎåÄÏÉÅÏûê Ïù¥Î¶Ñ ÌëúÏãú
            document.getElementById('targetName').textContent = `üíù ${decodeURIComponent(userName)} Îãò`;
            
            showQuestion();
        }

        // ÏßàÎ¨∏ ÌëúÏãú
        function showQuestion() {
            const question = questions[currentQuestionIndex];
            document.getElementById('currentQuestion').innerHTML = question.text;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.innerHTML = `
                    <span class="option-emoji">${option.emoji}</span>
                    <span class="option-text">${option.text}</span>
                `;
                optionDiv.onclick = () => selectOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            updateProgress();
        }

        // ÏòµÏÖò ÏÑ†ÌÉù
        function selectOption(index, element) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            
            const question = questions[currentQuestionIndex];
            answers[currentQuestionIndex] = question.options[index].trait;
            
            // Î°úÎî© Ïï†ÎãàÎ©îÏù¥ÏÖò ÌëúÏãú
            document.getElementById('loadingAnimation').style.display = 'block';
            document.querySelector('.question-container').style.opacity = '0.5';
            
            // 0.8Ï¥à ÌõÑ Îã§Ïùå ÏßàÎ¨∏ÏúºÎ°ú ÏûêÎèô ÏßÑÌñâ
            setTimeout(() => {
                document.getElementById('loadingAnimation').style.display = 'none';
                document.querySelector('.question-container').style.opacity = '1';
                nextQuestion();
            }, 800);
        }

        // Îã§Ïùå ÏßàÎ¨∏
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                submitSurvey();
            }
        }

        // ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.querySelector('.progress-fill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${currentQuestionIndex + 1}/${questions.length} ÏßàÎ¨∏`;
        }

        // ÏÑ§Î¨∏ Ï†úÏ∂ú
        function submitSurvey() {
            // ÏùëÎãµ Ï†ÄÏû•
            surveys[currentSurvey].responses.push({
                answers: answers,
                timestamp: new Date().toISOString()
            });
            
            // ÌäπÏÑ±Î≥Ñ ÏßëÍ≥Ñ
            answers.forEach(trait => {
                if (!surveys[currentSurvey].traits[trait]) {
                    surveys[currentSurvey].traits[trait] = 0;
                }
                surveys[currentSurvey].traits[trait]++;
            });
            
            // ÏôÑÎ£å Î©îÏãúÏßÄ
            alert('üéâ ÏÜåÏ§ëÌïú ÏùëÏõê Î©îÏãúÏßÄÎ•º Î≥¥ÎÇ¥Ï£ºÏÖîÏÑú Í∞êÏÇ¨Ìï©ÎãàÎã§!\n\nÎãπÏã†Ïùò Îî∞ÎúªÌïú ÎßàÏùåÏù¥ ÎàÑÍµ∞Í∞ÄÏóêÍ≤å ÌÅ∞ ÌûòÏù¥ Îê† Í±∞ÏòàÏöî üíï\n\nÎãπÏã†ÎèÑ ÎèôÎ£åÎì§ÏóêÍ≤å ÎÇòÏùò Î™®ÏäµÏùÑ Î¨ºÏñ¥Î≥¥Í≥† Ïã∂Îã§Î©¥\nÏÉà Ï∞ΩÏóêÏÑú ÌÖåÏä§Ìä∏Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî! ‚ú®');
            
            // 3Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú ÏÉà ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            setTimeout(() => {
                window.open(window.location.origin + window.location.pathname, '_blank');
                window.close();
            }, 3000);
        }

        // Í≤∞Í≥º ÌëúÏãú
        function showResults(surveyId, userName) {
            const survey = surveys[surveyId];
            const totalResponses = survey.responses.length;
            
            // ÌÜµÍ≥Ñ ÌëúÏãú
            const statsContainer = document.getElementById('surveyStats');
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalResponses}</div>
                    <div class="stat-label">ÏùëÏõê Î©îÏãúÏßÄ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">üíï</div>
                    <div class="stat-label">${userName}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">‚ú®</div>
                    <div class="stat-label">Îß§Î†• Î∞úÍ≤¨</div>
                </div>
            `;
            
            // Í≤∞Í≥º ÏÑ§Î™Ö
            const resultDescription = document.getElementById('resultDescription');
            if (totalResponses === 0) {
                resultDescription.innerHTML = `
                    <p><strong>ÏïÑÏßÅ ÎèôÎ£åÎì§Ïùò Îî∞ÎúªÌïú ÏãúÏÑ†ÏùÑ Í∏∞Îã§Î¶¨Í≥† ÏûàÏñ¥Ïöî!</strong></p>
                    <p>ÎßÅÌÅ¨Î•º Í≥µÏú†Ìï¥ÏÑú ÎèôÎ£åÎì§Ïù¥<br>
                    ÎãπÏã†Ïóê ÎåÄÌï¥ Ïñ¥ÎñªÍ≤å ÏÉùÍ∞ÅÌïòÎäîÏßÄ ÏïåÏïÑÎ≥¥ÏÑ∏Ïöî üöÄ</p>
                    <p>Î∂ÑÎ™Ö ÏòàÏÉÅÎ≥¥Îã§ Ìõ®Ïî¨ ÏÇ¨ÎûëÎ∞õÍ≥† ÏûàÎäî<br>
                    ÏûêÏã†ÏùÑ Î∞úÍ≤¨ÌïòÍ≤å Îê† Í±∞ÏòàÏöî! ‚ú®</p>
                `;
            } else {
                const randomMessage = encouragementMessages[Math.floor(Math.random() * encouragementMessages.length)];
                resultDescription.innerHTML = `<p>${randomMessage}</p>`;
            }
            
            // Í≤∞Í≥º ÎÇ¥Ïö©
            const resultContainer = document.getElementById('resultContent');
            if (totalResponses === 0) {
                resultContainer.innerHTML = '';
            } else {
                // ÌäπÏÑ±Î≥Ñ ÌçºÏÑºÌä∏ Í≥ÑÏÇ∞ Î∞è ÌëúÏãú
                const sortedTraits = Object.entries(survey.traits)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5); // ÏÉÅÏúÑ 5Í∞úÎßå ÌëúÏãú
                
                resultContainer.innerHTML = sortedTraits.map(([trait, count]) => {
                    const percentage = Math.round((count / totalResponses) * 100);
                    const traitInfo = traitDescriptions[trait];
                    return `
                        <div class="trait-result">
                            <div class="trait-info">
                                <div class="trait-name">üíé ${traitInfo.name}</div>
                                <div class="trait-desc">${traitInfo.desc}</div>
                            </div>
                            <div class="trait-percentage">${percentage}%</div>
                        </div>
                    `;
                }).join('');
            }
            
            // Í≥µÏú† ÎßÅÌÅ¨ (ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÏùÑ URL ÌååÎùºÎØ∏ÌÑ∞Î°ú)
            const currentUrl = window.location.origin + window.location.pathname;
            const shareUrl = `${currentUrl}?user=${encodeURIComponent(userName)}`;
            document.getElementById('shareLink').textContent = shareUrl;
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            document.querySelector('.setup-section').style.display = 'none';
            document.querySelector('.result-section').classList.add('active');
        }

        // ÎßÅÌÅ¨ Î≥µÏÇ¨
        function copyLink() {
            const link = document.getElementById('shareLink').textContent;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(link).then(() => {
                    showCopySuccess();
                });
            } else {
                const textArea = document.createElement('textarea');
                textArea.value = link;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopySuccess();
            }
        }

        function showCopySuccess() {
            alert('‚úÖ ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!\n\nüî• Ïπ¥ÌÜ°, Ïä¨Îûô, Ïù¥Î©îÏùº Ïñ¥ÎîîÎì† Î≥¥ÎÇ¥Ï£ºÏÑ∏Ïöî!\nÎèôÎ£åÎì§Ïù¥ ÌÅ¥Î¶≠ Ìïú Î≤àÏúºÎ°ú Î∞îÎ°ú Ï∞∏Ïó¨Ìï† Ïàò ÏûàÏñ¥Ïöî üíï\n\nÎ∂ÑÎ™Ö Îî∞ÎúªÌïú ÏùëÏõêÏùÑ ÎßéÏù¥ Î∞õÏúºÏã§ Í±∞ÏòàÏöî! ‚ú®');
        }

        // ÏÉà ÏÑ§Î¨∏ ÎßåÎì§Í∏∞
        function createNewSurvey() {
            if (confirm('ÏÉàÎ°úÏö¥ ÏÑ§Î¨∏ÏùÑ ÎßåÎìúÏãúÍ≤†Ïñ¥Ïöî? üÜï')) {
                // URLÏóêÏÑú ÌååÎùºÎØ∏ÌÑ∞ Ï†úÍ±∞
                window.history.replaceState({}, document.title, window.location.pathname);
                location.reload();
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', () => {
            const userName = getUserFromUrl();
            
            if (userName) {
                // URLÏóê ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÏù¥ ÏûàÏúºÎ©¥ ÏÑ§Î¨∏ Ï∞∏Ïó¨ Î™®Îìú
                startSurveyFromUrl();
            } else {
                // ÏóÜÏúºÎ©¥ ÏÑ§Î¨∏ ÏÉùÏÑ± Î™®Îìú
                document.querySelector('.setup-section').classList.add('active');
            }
        });

        // ÌéòÏù¥ÏßÄ Ïù¥ÌÉà Î∞©ÏßÄ (ÏÑ§Î¨∏ ÏßÑÌñâ Ï§ëÏùº Îïå)
        window.addEventListener('beforeunload', (e) => {
            if (currentSurvey && currentQuestionIndex > 0 && currentQuestionIndex < questions.length) {
                e.preventDefault();
                e.returnValue = 'ÏÑ§Î¨∏Ïù¥ ÏïÑÏßÅ ÏôÑÎ£åÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§. Ï†ïÎßê ÎÇòÍ∞ÄÏãúÍ≤†Ïñ¥Ïöî?';
            }
        });
    </script>
</body>
</html>

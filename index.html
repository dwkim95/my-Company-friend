<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <meta name="description" content="ì¹œêµ¬ë“¤ì´ ë°”ë¼ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµì„ ë°œê²¬í•´ë³´ì„¸ìš”. ë”°ëœ»í•˜ê³  ì¬ë¯¸ìˆëŠ” ì„±í–¥ ë¶„ì„ í…ŒìŠ¤íŠ¸ë¡œ ì†Œì¤‘í•œ ê´€ê³„ë¥¼ ë”ìš± ê¹Šê²Œ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
    <meta name="keywords" content="ì¹œêµ¬í…ŒìŠ¤íŠ¸, ì„±í–¥ë¶„ì„, ì¸ê°„ê´€ê³„, ì‹¬ë¦¬í…ŒìŠ¤íŠ¸, ì„±ê²©í…ŒìŠ¤íŠ¸, ì¹œêµ¬ë“¤ì´ë³´ëŠ”ë‚˜">
    <meta name="author" content="ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph ë©”íƒ€ íƒœê·¸ (ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ ìš©) -->
    <meta property="og:title" content="ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµ">
    <meta property="og:description" content="ì¹œêµ¬ë“¤ì˜ ì‹œì„ ìœ¼ë¡œ ë°œê²¬í•˜ëŠ” ë‚˜ì˜ ìˆ¨ê²¨ì§„ ë§¤ë ¥ê³¼ íŠ¹ë³„í•œ ëª¨ìŠµë“¤">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:site_name" content="ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜">
    <meta property="og:locale" content="ko_KR">
    
    <!-- Twitter Card ë©”íƒ€ íƒœê·¸ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµ">
    <meta name="twitter:description" content="ì¹œêµ¬ë“¤ì˜ ì‹œì„ ìœ¼ë¡œ ë°œê²¬í•˜ëŠ” ë‚˜ì˜ ìˆ¨ê²¨ì§„ ë§¤ë ¥ê³¼ íŠ¹ë³„í•œ ëª¨ìŠµë“¤">
    <meta name="twitter:image" content="">
    
    <!-- ëª¨ë°”ì¼ ìµœì í™” -->
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜">
    
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’</text></svg>">
    
    <!-- ì›¹ í°íŠ¸ ìµœì í™” -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- CSS ìµœì í™” -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800&display=swap"></noscript>
    
    <!-- ë³´ì•ˆ ë° ì„±ëŠ¥ -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <title>ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµ | ì„±í–¥ ë¶„ì„ í…ŒìŠ¤íŠ¸</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --white: #ffffff;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            background-size: 400% 400%;
            animation: gradientFlow 15s ease infinite;
            min-height: 100vh;
            padding: 1rem;
            line-height: 1.6;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .app-container {
            max-width: 480px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
            overflow: hidden;
            position: relative;
        }

        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            padding: 2rem 1.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-60px) translateY(-60px); }
        }

        .app-title {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .app-subtitle {
            font-size: 0.95rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .app-content {
            padding: 2rem 1.5rem;
        }

        .screen {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: var(--gray-50);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--white);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border: 2px solid var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .progress-container {
            margin-bottom: 2rem;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .progress-text {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .question-card {
            background: var(--gray-50);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray-200);
        }

        .question-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--gray-800);
            text-align: center;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            gap: 0.75rem;
        }

        .option-card {
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .option-card.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            transform: scale(1.02);
        }

        .option-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .option-emoji {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .option-text {
            font-weight: 500;
            line-height: 1.3;
        }

        .survey-intro {
            text-align: center;
            margin-bottom: 2rem;
        }

        .target-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .survey-description {
            color: var(--gray-600);
            line-height: 1.6;
        }

        .loading-screen {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .loading-dots {
            color: var(--primary);
            font-size: 1.1rem;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--gray-200);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .result-card {
            background: var(--gray-50);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray-200);
        }

        .result-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .result-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 0.5rem;
        }

        .result-description {
            color: var(--gray-600);
            line-height: 1.6;
        }

        .trait-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .trait-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--white);
            padding: 1rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .trait-info {
            flex: 1;
        }

        .trait-name {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.25rem;
        }

        .trait-desc {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        .trait-percentage {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
            margin-left: 1rem;
        }

        .encouragement-card {
            background: linear-gradient(135deg, #fff8f0, #fef7ff);
            border: 1px solid #fde5ff;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: #8b5a3c;
            line-height: 1.6;
        }

        .share-section {
            margin-top: 2rem;
        }

        .share-description {
            text-align: center;
            color: var(--gray-600);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .share-link {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
            word-break: break-all;
            color: var(--primary);
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: all;
        }

        .share-link:hover {
            border-color: var(--primary);
            background: var(--white);
        }

        .share-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .share-btn {
            padding: 0.875rem 1rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .share-btn.kakao {
            background: #fee500;
            color: #3c1e1e;
        }

        .share-btn.copy {
            background: var(--primary);
            color: var(--white);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .floating-emojis {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-emoji {
            position: absolute;
            font-size: 2rem;
            opacity: 0.3;
            animation: floatAround 12s ease-in-out infinite;
        }

        @keyframes floatAround {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg);
                opacity: 0.3;
            }
            50% { 
                transform: translateY(-30px) rotate(15deg);
                opacity: 0.6;
            }
        }

        .participant-counter {
            text-align: center;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, #f8faff, #f0f3ff);
            border-radius: 16px;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray-200);
        }

        .count-display {
            margin-bottom: 1rem;
        }

        .count-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            display: block;
            line-height: 1;
        }

        .count-label {
            font-size: 1.1rem;
            color: var(--gray-600);
            font-weight: 600;
        }

        .count-description {
            color: var(--gray-500);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .count-description span {
            color: var(--primary);
            font-weight: 600;
        }

        .detailed-report {
            background: var(--white);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray-200);
        }

        .report-header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--gray-100);
        }

        .report-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-800);
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .report-subtitle {
            color: var(--gray-600);
            font-size: 1rem;
            line-height: 1.7;
            max-width: 400px;
            margin: 0 auto;
        }

        .personality-summary {
            background: linear-gradient(135deg, #f8faff, #fef7ff);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border-left: 4px solid var(--primary);
        }

        .summary-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1rem;
        }

        .summary-text {
            color: var(--gray-700);
            line-height: 1.8;
            font-size: 1rem;
        }

        .trait-analysis {
            margin-bottom: 2rem;
        }

        .analysis-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .top-traits {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .trait-item-detailed {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            border: 2px solid var(--gray-100);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .trait-item-detailed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        .trait-item-detailed:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .trait-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .trait-name-detailed {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-800);
        }

        .trait-percentage-detailed {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary);
        }

        .trait-description-detailed {
            color: var(--gray-600);
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .trait-meaning {
            background: var(--gray-50);
            border-radius: 12px;
            padding: 1rem;
            color: var(--gray-700);
            font-size: 0.9rem;
            line-height: 1.6;
            font-style: italic;
        }

        .closing-message {
            background: linear-gradient(135deg, #fff8f0, #fef7ff);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            margin-top: 2rem;
            border: 1px solid #fde5ff;
        }

        .closing-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1rem;
        }

        .closing-text {
            color: var(--gray-700);
            line-height: 1.8;
            font-size: 1rem;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ ì™„ì„± */
        @media (max-width: 640px) {
            .app-container {
                margin: 0.5rem;
                border-radius: 16px;
            }

            .app-header {
                padding: 1.5rem 1rem;
            }

            .app-content {
                padding: 1.5rem 1rem;
            }

            .app-title {
                font-size: 1.5rem;
            }

            .result-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .share-buttons {
                grid-template-columns: 1fr;
            }

            .trait-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .trait-percentage {
                margin-left: 0;
                align-self: flex-end;
            }

            .detailed-report {
                padding: 1.5rem;
            }

            .report-title {
                font-size: 1.5rem;
            }

            .count-number {
                font-size: 2.5rem;
            }

            .trait-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .trait-percentage-detailed {
                align-self: flex-end;
            }

            .personality-summary {
                padding: 1.5rem;
            }

            .summary-title {
                font-size: 1.1rem;
            }

            .trait-item-detailed {
                padding: 1.25rem;
            }

            .closing-message {
                padding: 1.5rem;
            }

            .question-title {
                font-size: 1.1rem;
            }

            .option-card {
                padding: 0.875rem;
            }

            .option-emoji {
                font-size: 1.25rem;
            }

            .participant-counter {
                padding: 1.5rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .app-container {
                margin: 0.25rem;
            }

            .app-title {
                font-size: 1.3rem;
            }

            .report-title {
                font-size: 1.3rem;
            }

            .summary-title, .analysis-title {
                font-size: 1rem;
            }

            .trait-name-detailed {
                font-size: 1rem;
            }

            .encouragement-card h3 {
                font-size: 1rem;
            }

            .form-input {
                padding: 0.875rem;
            }

            .btn {
                padding: 0.875rem 1.25rem;
            }
        }

        /* ì ‘ê·¼ì„± ê°œì„  */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (prefers-color-scheme: dark) {
            .app-container {
                background: rgba(30, 30, 30, 0.97);
                color: #f3f4f6;
            }

            .result-card, .detailed-report {
                background: #1f2937;
                color: #f3f4f6;
            }

            .form-input {
                background: #374151;
                color: #f3f4f6;
                border-color: #4b5563;
            }

            .encouragement-card {
                background: linear-gradient(135deg, #1f2937, #374151);
                color: #f3f4f6;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* ë¡œë”© ìƒíƒœ ê°œì„  */
        .loading {
            opacity: 0.6;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        /* ìŠ¤í¬ë¡¤ ìµœì í™” */
        .app-container {
            scroll-behavior: smooth;
        }

        /* í„°ì¹˜ ìµœì í™” */
        .option-card, .btn, .share-btn {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* ê³ í•´ìƒë„ ë””ìŠ¤í”Œë ˆì´ ìµœì í™” */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .app-header {
                background-image: linear-gradient(135deg, var(--primary), var(--secondary));
            }
        }

        /* ì ‘ê·¼ì„± */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <!-- ë– ë‹¤ë‹ˆëŠ” ì´ëª¨ì§€ ë°°ê²½ -->
    <div class="floating-emojis">
        <div class="floating-emoji" style="top: 10%; left: 10%; animation-delay: 0s;">ğŸŒ»</div>
        <div class="floating-emoji" style="top: 20%; right: 15%; animation-delay: 2s;">ğŸˆ</div>
        <div class="floating-emoji" style="bottom: 30%; left: 20%; animation-delay: 4s;">ğŸ€</div>
        <div class="floating-emoji" style="bottom: 20%; right: 10%; animation-delay: 6s;">ğŸŒˆ</div>
        <div class="floating-emoji" style="top: 50%; left: 5%; animation-delay: 1s;">ğŸ¯</div>
        <div class="floating-emoji" style="top: 60%; right: 8%; animation-delay: 3s;">â­</div>
    </div>

    <div class="app-container">
        <header class="app-header">
            <h1 class="app-title">ì¹œêµ¬ë“¤ì´ ë³´ëŠ” ë‚˜</h1>
            <p class="app-subtitle">
                ì†Œì¤‘í•œ ì‚¬ëŒë“¤ì˜ ì‹œì„ ìœ¼ë¡œ ë°œê²¬í•˜ëŠ”<br>
                ë‚˜ì˜ ìˆ¨ê²¨ì§„ ë§¤ë ¥ê³¼ íŠ¹ë³„í•œ ëª¨ìŠµë“¤
            </p>
        </header>

        <main class="app-content">
            <!-- ì„¤ë¬¸ ìƒì„± í™”ë©´ -->
            <div id="setupScreen" class="screen active">
                <div class="encouragement-card">
                    <h3 style="margin-bottom: 1rem; color: #667eea;">ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ íŠ¹ë³„í•œ ì¡´ì¬ì…ë‹ˆë‹¤</h3>
                    <p>
                        ì¹œêµ¬ë“¤ì˜ ì‹œì„ ì—ì„œ ë°œê²¬ë <br>
                        ë‹¹ì‹ ì˜ ë°˜ì§ì´ëŠ” ëª¨ìŠµë“¤ì´ ì •ë§ ê¸°ëŒ€ë¼ìš”
                    </p>
                </div>
                
                <form id="setupForm">
                    <div class="form-group">
                        <label for="userName" class="form-label">ë‹‰ë„¤ì„</label>
                        <input 
                            type="text" 
                            id="userName" 
                            class="form-input"
                            placeholder="ì˜ˆ: ë”°ëœ»í•œ ê¹€ë¯¼ìˆ˜, í–‡ì‚´ ê°™ì€ ì§€ì˜ì´"
                            required
                        >
                    </div>
                    
                    <button type="submit" class="btn">
                        ë‚´ ì „ìš© ë§í¬ ë§Œë“¤ê¸°
                    </button>
                </form>
                
                <div class="encouragement-card">
                    <h3 style="margin-bottom: 1rem; color: #667eea;">ê°„ë‹¨í•œ ë§í¬ ê³µìœ ë¡œ ì‹œì‘í•˜ì„¸ìš”</h3>
                    <p>
                        ë§í¬ë¥¼ ë§Œë“¤ë©´ ì¹œêµ¬ë“¤ì´ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ<br>
                        ë°”ë¡œ ë‹¹ì‹ ì— ëŒ€í•œ ì„¤ë¬¸ì— ì°¸ì—¬í•  ìˆ˜ ìˆì–´ìš”<br>
                        ì¹´í†¡ì´ë‚˜ ë©”ì‹ ì €ë¡œ ë§í¬ë§Œ ë³´ë‚´ë©´ ë!
                    </p>
                </div>
            </div>

            <!-- ì„¤ë¬¸ ì°¸ì—¬ í™”ë©´ -->
            <div id="surveyScreen" class="screen">
                <div class="survey-intro">
                    <div id="targetName" class="target-name"></div>
                    <div class="survey-description">
                        ì´ ì†Œì¤‘í•œ ë¶„ì— ëŒ€í•´<br>
                        ë‹¹ì‹ ì´ ëŠë¼ëŠ” ì†”ì§í•œ ìƒê°ì„ ë“¤ë ¤ì£¼ì„¸ìš”<br>
                        ë‹¹ì‹ ì˜ ë”°ëœ»í•œ ì‹œì„ ì´ ëˆ„êµ°ê°€ì—ê²ŒëŠ” í° í˜ì´ ë  ê±°ì˜ˆìš”
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-info">
                        <span id="progressText" class="progress-text">1/10 ì§ˆë¬¸</span>
                        <span class="progress-text">ğŸ“</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                </div>
                
                <div class="question-card">
                    <h2 id="questionTitle" class="question-title"></h2>
                    <div id="optionsContainer" class="options-grid"></div>
                </div>

                <div id="loadingScreen" class="loading-screen">
                    <div class="loading-dots">ë‹µë³€ì„ ì €ì¥í•˜ê³  ìˆì–´ìš”</div>
                </div>
            </div>

            <!-- ì„¤ë¬¸ ì™„ë£Œ í™”ë©´ -->
            <div id="surveyCompleteScreen" class="screen">
                <div class="encouragement-card">
                    <h3 style="margin-bottom: 1rem; color: #667eea;">ì„¤ë¬¸ ì™„ë£Œ</h3>
                    <p>
                        ì†Œì¤‘í•œ ë§ˆìŒì„ ì „í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.<br>
                        ë‹¹ì‹ ì˜ ì§„ì‹¬ì–´ë¦° ì‘ë‹µì´ ëˆ„êµ°ê°€ì—ê²Œ<br>
                        í° í˜ê³¼ ìœ„ë¡œê°€ ë  ê²ƒì…ë‹ˆë‹¤.
                    </p>
                </div>

                <div class="result-card">
                    <div class="result-header">
                        <h2 class="result-title">í˜„ì¬ ì°¸ì—¬ í˜„í™©</h2>
                        <div class="result-description">
                            <div id="completeTargetName" class="target-name"></div>
                            <p>ë‹˜ì˜ ì„¤ë¬¸ì— ì°¸ì—¬í•´ì£¼ì‹  ë¶„ë“¤</p>
                        </div>
                    </div>
                    
                    <div id="participantCount" class="participant-counter">
                        <div class="count-display">
                            <span class="count-number">0</span>
                            <span class="count-label">ëª… ì°¸ì—¬</span>
                        </div>
                        <div class="count-description">
                            ê²°ê³¼ ê°œë´‰ê¹Œì§€ <span id="remainingCount">3</span>ëª… ë” í•„ìš”í•´ìš”
                        </div>
                    </div>
                    
                    <button id="viewResultsBtn" class="btn" style="display: none;">
                        ê²°ê³¼ í™•ì¸í•˜ê¸°
                    </button>
                </div>

                <div class="encouragement-card">
                    <h3 style="margin-bottom: 1rem; color: #667eea;">ë‚˜ë§Œì˜ ì„¤ë¬¸ ë§Œë“¤ê¸°</h3>
                    <p>
                        ì¹œêµ¬ë“¤ì´ ë°”ë¼ë³´ëŠ” ë‹¹ì‹ ì˜ ëª¨ìŠµì´<br>
                        ê¶ê¸ˆí•˜ì§€ ì•Šìœ¼ì‹ ê°€ìš”?<br>
                        ì§€ê¸ˆ ë°”ë¡œ ë‚˜ë§Œì˜ ë§í¬ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.
                    </p>
                </div>

                <div class="form-group">
                    <label for="newUserName" class="form-label">ë‹‰ë„¤ì„</label>
                    <input 
                        type="text" 
                        id="newUserName" 
                        class="form-input"
                        placeholder="ì˜ˆ: ë”°ëœ»í•œ ê¹€ë¯¼ìˆ˜, í–‡ì‚´ ê°™ì€ ì§€ì˜ì´"
                    >
                </div>
                
                <button id="createMyLinkBtn" class="btn">
                    ë‚´ ì „ìš© ë§í¬ ë§Œë“¤ê¸°
                </button>

                <div class="share-buttons" style="margin-top: 1rem;">
                    <button id="restartBtn" class="btn btn-secondary">
                        ë‹¤ë¥¸ ì¹œêµ¬ ì„¤ë¬¸í•˜ê¸°
                    </button>
                </div>
            </div>

            <!-- ê²°ê³¼ í™”ë©´ -->
            <div id="resultScreen" class="screen">
                <div id="resultStats" class="result-stats"></div>
                
                <div id="resultContent"></div>
                
                <div class="share-section">
                    <p class="share-description">
                        ë” ë§ì€ ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜í•˜ê³  ì‹¶ë‹¤ë©´<br>
                        ì•„ë˜ ë§í¬ë¥¼ ê³µìœ í•´ì„œ ë” ë§ì€ ë”°ëœ»í•œ ì‹œì„ ë“¤ì„ ëª¨ì•„ë³´ì„¸ìš”
                    </p>
                    <div id="shareLink" class="share-link"></div>
                    
                    <div class="share-buttons">
                        <button id="kakaoShareBtn" class="share-btn kakao">
                            ì¹´ì¹´ì˜¤í†¡ ê³µìœ 
                        </button>
                        <button id="copyLinkBtn" class="share-btn copy">
                            ë§í¬ ë³µì‚¬
                        </button>
                    </div>

                    <div class="encouragement-card" style="margin-top: 2rem;">
                        <h3 style="margin-bottom: 1rem; color: #667eea;">ì–¸ì œë“  ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”</h3>
                        <p>
                            ì´ ë§í¬ë¥¼ ë¶ë§ˆí¬í•´ë‘ì‹œë©´<br>
                            ì–¸ì œë“  ìµœì‹  ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”
                        </p>
                        <div id="ownerLink" class="share-link" style="margin-top: 1rem; font-size: 0.85rem;"></div>
                    </div>
                    
                    <button id="newSurveyBtn" class="btn btn-secondary" style="margin-top: 1rem;">
                        ìƒˆë¡œìš´ ë§¤ë ¥ ë°œêµ´í•˜ê¸°
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ
        const AppState = {
            currentUser: null,
            currentUserName: null, // í˜„ì¬ ì‚¬ìš©ìëª… ì €ì¥
            currentQuestionIndex: 0,
            answers: [],
            surveys: {},
            isAnswering: false,
            minParticipants: 3 // ê²°ê³¼ ê°œë´‰ì„ ìœ„í•œ ìµœì†Œ ì°¸ì—¬ì ìˆ˜
        };

        // ì„¤ë¬¸ ì§ˆë¬¸ ë°ì´í„° (ì¹œêµ¬ë“¤ ëŒ€ìƒ, ë”°ëœ»í•˜ê³  ì¬ë¯¸ìˆëŠ” ìƒí™©)
        const QUESTIONS = [
            {
                text: "ìƒˆë²½ 2ì‹œ, ê°‘ìê¸° ë‹¨í†¡ì—ì„œ<br>ê³ ë¯¼ ìƒë‹´ì„ ì‹œì‘í•˜ëŠ” ì¹œêµ¬ê°€ ìˆë‹¤ë©´",
                options: [
                    { emoji: "ğŸ’­", text: "3ì´ˆ ì•ˆì— ë‹µì¥í•˜ë©° ì§„ì‹¬ì–´ë¦° ì¡°ì–¸ì„ ê±´ë„¤ëŠ” ì‚¬ëŒ", trait: "empathetic" },
                    { emoji: "ğŸ¤—", text: "ë”°ëœ»í•œ ìœ„ë¡œì˜ ë§ë¡œ ë§ˆìŒì„ ë‹¤ë…ì—¬ì£¼ëŠ” ì‚¬ëŒ", trait: "comforting" },
                    { emoji: "â˜•", text: "ë‚´ì¼ ë§Œë‚˜ì„œ ì»¤í”¼ í•œ ì” í•˜ë©° ì²œì²œíˆ ë“¤ì–´ë³´ìëŠ” ì‚¬ëŒ", trait: "thoughtful" },
                    { emoji: "ğŸµ", text: "íë§ë˜ëŠ” ìŒì•…ì´ë‚˜ ì˜ìƒì„ ê³µìœ í•´ì£¼ëŠ” ì‚¬ëŒ", trait: "healing" }
                ]
            },
            {
                text: "ì¹œêµ¬ë“¤ê³¼ ì—¬í–‰ ê³„íšì„ ì„¸ìš¸ ë•Œ<br>ì´ ì‚¬ëŒì˜ ì—­í• ì€",
                options: [
                    { emoji: "ğŸ“‹", text: "ë²Œì¨ ë§›ì§‘ ë¦¬ìŠ¤íŠ¸ì™€ ì¼ì •í‘œë¥¼ ì™„ë²½í•˜ê²Œ ì¤€ë¹„í•œ í”Œë˜ë„ˆ", trait: "organized" },
                    { emoji: "ğŸ’¡", text: "ë‚¨ë“¤ì´ ìƒê° ëª»í•œ ìˆ¨ì€ ëª…ì†Œë¥¼ ë°œêµ´í•´ë‚´ëŠ” íƒí—˜ê°€", trait: "creative" },
                    { emoji: "ğŸŒˆ", text: "ëª¨ë“  ì¹œêµ¬ì˜ ì˜ê²¬ì„ ì¡°ìœ¨í•˜ë©° í™”í•©ì„ ì´ë„ëŠ” ì¤‘ì¬ì", trait: "harmonious" },
                    { emoji: "ğŸ’", text: "ì–´ë””ë“  ì¢‹ë‹¤ë©° ìˆœìˆ˜í•˜ê²Œ ê¸°ëŒ€í•˜ëŠ” ì—¬í–‰ ëŸ¬ë²„", trait: "easygoing" }
                ]
            },
            {
                text: "ì¹œêµ¬ ìƒì¼ ê¹œì§ íŒŒí‹°ë¥¼ ì¤€ë¹„í•  ë•Œ<br>ê°€ì¥ ë¨¼ì € í•˜ëŠ” ì¼ì€",
                options: [
                    { emoji: "ğŸ¨", text: "ì†ìˆ˜ ë§Œë“  íŠ¹ë³„í•œ ì„ ë¬¼ì´ë‚˜ ì˜ìƒì„ ì¤€ë¹„í•˜ëŠ” ê²ƒ", trait: "artistic" },
                    { emoji: "ğŸ“", text: "ëª¨ë“  ì¹œêµ¬ë“¤ì—ê²Œ ì—°ë½í•´ì„œ ì°¸ì—¬ë¥¼ ë…ë ¤í•˜ëŠ” ê²ƒ", trait: "social" },
                    { emoji: "ğŸ”", text: "ì£¼ì¸ê³µì´ ì§„ì§œ ì¢‹ì•„í•  ë§Œí•œ ê²ƒë“¤ì„ ë¦¬ì„œì¹˜í•˜ëŠ” ê²ƒ", trait: "attentive" },
                    { emoji: "ğŸª", text: "ì¬ë°ŒëŠ” ê²Œì„ì´ë‚˜ ì´ë²¤íŠ¸ ì•„ì´ë””ì–´ë¥¼ ê¸°íší•˜ëŠ” ê²ƒ", trait: "entertaining" }
                ]
            },
            {
                text: "ê°‘ìê¸° ë¹„ê°€ ìŸì•„ì§€ëŠ” ë‚ <br>ìš°ì‚° ì—†ëŠ” ì¹œêµ¬ë¥¼ ë§Œë‚¬ì„ ë•Œ",
                options: [
                    { emoji: "â˜‚ï¸", text: "ë‹¹ì—°í•˜ë‹¤ëŠ” ë“¯ ìì‹ ì˜ ìš°ì‚°ì„ ê°™ì´ ì“°ìê³  í•˜ëŠ” ì‚¬ëŒ", trait: "generous" },
                    { emoji: "ğŸƒ", text: "ë¹ ë¥´ê²Œ ì£¼ë³€ í¸ì˜ì ì´ë‚˜ ì¹´í˜ë¥¼ ì°¾ì•„ ì•ˆë‚´í•˜ëŠ” ì‚¬ëŒ", trait: "practical" },
                    { emoji: "ğŸ­", text: "ë¹„ ë§ëŠ” ìƒí™©ë„ ì¬ë°Œê²Œ ë§Œë“¤ì–´ë²„ë¦¬ëŠ” ê¸ì •ëŸ¬", trait: "optimistic" },
                    { emoji: "ğŸš—", text: "ë°”ë¡œ ì°¨ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ íƒì‹œë¥¼ ë¶ˆëŸ¬ì£¼ëŠ” í•´ê²°ì‚¬", trait: "reliable" }
                ]
            },
            {
                text: "ì¹œêµ¬ê°€ ìƒˆë¡œìš´ ë„ì „ì„ í•˜ê² ë‹¤ê³  í•  ë•Œ<br>ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” ë°˜ì‘ì€",
                options: [
                    { emoji: "ğŸ”¥", text: "ì™€ ëŒ€ë°•! ì§„ì§œ ë©‹ìˆë‹¤! ì‘ì›í• ê²Œ!", trait: "supportive" },
                    { emoji: "ğŸ¤”", text: "ì‹ ì¤‘í•˜ê²Œ ì¥ë‹¨ì ì„ í•¨ê»˜ ê³ ë¯¼í•´ë³´ìëŠ” ì¡°ì–¸", trait: "wise" },
                    { emoji: "ğŸ’ª", text: "ë‚˜ë„ í•¨ê»˜ ë„ì „í•´ë³¼ê¹Œ? ê°™ì´ í•˜ë©´ ë” ì¬ë°Œì„ ê²ƒ ê°™ì€ë°", trait: "adventurous" },
                    { emoji: "ğŸ“š", text: "ê´€ë ¨ ì •ë³´ë‚˜ ê²½í—˜ë‹´ì„ ì°¾ì•„ì„œ ê³µìœ í•´ì£¼ëŠ” ê²ƒ", trait: "helpful" }
                ]
            },
            {
                text: "ì¹œêµ¬ë“¤ê³¼ ë§›ì§‘ì— ê°”ëŠ”ë°<br>ìŒì‹ì´ ì˜ˆìƒê³¼ ë‹¬ë¼ì„œ ì‹¤ë§ìŠ¤ëŸ¬ìš¸ ë•Œ",
                options: [
                    { emoji: "ğŸ˜„", text: "ì´ê²ƒë„ ì¶”ì–µì´ì§€! í•˜ë©° ë¶„ìœ„ê¸°ë¥¼ ë°ê²Œ ë§Œë“œëŠ” ì‚¬ëŒ", trait: "cheerful" },
                    { emoji: "ğŸ“¸", text: "ê·¸ë˜ë„ ì¸ì¦ìƒ·ì€ ì˜ˆì˜ê²Œ ì°ì–´ì£¼ëŠ” ì‚¬ì§„ ì‘ê°€", trait: "positive" },
                    { emoji: "ğŸ°", text: "ë‹¤ìŒì—” ë‚´ê°€ ì§„ì§œ ë§›ìˆëŠ” ê³³ ì¶”ì²œí•´ì¤„ê²Œ! í•˜ëŠ” ì‚¬ëŒ", trait: "caring" },
                    { emoji: "ğŸˆ", text: "ìŒì‹ë³´ë‹¤ í•¨ê»˜ ìˆëŠ” ì‹œê°„ì´ ë” ì†Œì¤‘í•˜ë‹¤ê³  ë§í•˜ëŠ” ì‚¬ëŒ", trait: "philosophical" }
                ]
            },
            {
                text: "ì¹œêµ¬ê°€ í˜ë“  ì¼ë¡œ ë§ì´ ìš°ìš¸í•´í•  ë•Œ<br>ê°€ì¥ ìì—°ìŠ¤ëŸ½ê²Œ í•˜ëŠ” í–‰ë™ì€",
                options: [
                    { emoji: "ğŸ‘‚", text: "ë°¤ìƒˆì›Œì„œë¼ë„ ëê¹Œì§€ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ì£¼ëŠ” ê²ƒ", trait: "devoted" },
                    { emoji: "ğŸ", text: "ì‘ì€ ì„ ë¬¼ì´ë‚˜ í¸ì§€ë¡œ ë§ˆìŒì„ ì „í•˜ëŠ” ê²ƒ", trait: "affectionate" },
                    { emoji: "ğŸš¶", text: "í•¨ê»˜ ì‚°ì±…í•˜ê±°ë‚˜ ë“œë¼ì´ë¸Œë¥¼ ì œì•ˆí•˜ëŠ” ê²ƒ", trait: "therapeutic" },
                    { emoji: "â˜€ï¸", text: "ìì—°ìŠ¤ëŸ½ê²Œ ì¼ìƒ ì´ì•¼ê¸°ë¡œ ê¸°ë¶„ ì „í™˜ì„ ë„ì™€ì£¼ëŠ” ê²ƒ", trait: "uplifting" }
                ]
            },
            {
                text: "ë‹¨í†¡ë°©ì—ì„œ ì´ ì‚¬ëŒì˜<br>ëŒ€í‘œì ì¸ ëª¨ìŠµì€",
                options: [
                    { emoji: "âš¡", text: "ëˆ„ê°€ ë­”ê°€ ì˜¬ë¦¬ë©´ ë°”ë¡œë°”ë¡œ ë°˜ì‘í•´ì£¼ëŠ” ë¹ ë¥¸ ì†Œí†µëŸ¬", trait: "responsive" },
                    { emoji: "ğŸ’«", text: "ë¶„ìœ„ê¸°ì— ë§ëŠ” ì™„ë²½í•œ ì§¤ì´ë‚˜ ì´ëª¨í‹°ì½˜ì„ êµ¬ì‚¬í•˜ëŠ” ì„¼ìŠ¤ìŸì´", trait: "witty" },
                    { emoji: "ğŸ“", text: "ì¤‘ìš”í•œ ì •ë³´ëŠ” ê¹”ë”í•˜ê²Œ ì •ë¦¬í•´ì„œ ê³µìœ í•˜ëŠ” ì •ë¦¬ì™•", trait: "informative" },
                    { emoji: "ğŸŒ¸", text: "ì¡°ìš©íˆ ì§€ì¼œë³´ë‹¤ê°€ ë”°ëœ»í•œ í•œë§ˆë””ë¡œ ê°ë™ì„ ì£¼ëŠ” ì‚¬ëŒ", trait: "gentle" }
                ]
            },
            {
                text: "ì¹œêµ¬ë“¤ ì‚¬ì´ì—ì„œ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ<br>ì´ ì‚¬ëŒì˜ ëª¨ìŠµì€",
                options: [
                    { emoji: "ğŸ•Šï¸", text: "ì–‘ìª½ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ë³´ë©° ì¤‘ì¬ ì—­í• ì„ í•˜ëŠ” í‰í™”ì£¼ì˜ì", trait: "mediator" },
                    { emoji: "ğŸ¤²", text: "ëª¨ë‘ì˜ ë§ˆìŒì„ ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•˜ëŠ” ê³µê° ì „ë¬¸ê°€", trait: "understanding" },
                    { emoji: "ğŸŒ¿", text: "ì‹œê°„ì´ í•´ê²°í•´ì¤„ ê±°ë¼ë©° ìì—°ìŠ¤ëŸ½ê²Œ ë¶„ìœ„ê¸°ë¥¼ ë°”ê¾¸ëŠ” ì‚¬ëŒ", trait: "peaceful" },
                    { emoji: "ğŸ’", text: "ê°ì ê°œë³„ì ìœ¼ë¡œ ë§Œë‚˜ì„œ ë§ˆìŒì„ ë‹¬ë˜ì£¼ëŠ” ì¼€ì–´í…Œì´ì»¤", trait: "nurturing" }
                ]
            },
            {
                text: "ì´ ì‚¬ëŒê³¼ í•¨ê»˜ ìˆìœ¼ë©´<br>ê°€ì¥ ìì£¼ ëŠë¼ê²Œ ë˜ëŠ” ê°ì •ì€",
                options: [
                    { emoji: "âœ¨", text: "ë”°ëœ»í•¨ê³¼ ì•ˆì •ê°, ë§ˆì¹˜ ê³ í–¥ ê°™ì€ í¸ì•ˆí•¨", trait: "comforting" },
                    { emoji: "ğŸˆ", text: "ì¦ê±°ì›€ê³¼ ìœ ì¾Œí•¨, ì‹œê°„ ê°€ëŠ” ì¤„ ëª¨ë¥´ëŠ” ì¬ë¯¸", trait: "joyful" },
                    { emoji: "ğŸŒŸ", text: "ì˜ê°ê³¼ ë™ê¸°ë¶€ì—¬, ë‚˜ë„ ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ì€ ë§ˆìŒ", trait: "inspiring" },
                    { emoji: "ğŸ¤", text: "ê¹Šì€ ì‹ ë¢°ì™€ ë¯¿ìŒ, ë¬´ì—‡ì´ë“  í„¸ì–´ë†“ê³  ì‹¶ì€ ë§ˆìŒ", trait: "trustworthy" }
                ]
            }
        ];

        // íŠ¹ì„± ì„¤ëª… ë°ì´í„° (MZê°ì„±, íŠ¸ë Œë””í•œ í‚¤ì›Œë“œ)
        const TRAIT_DESCRIPTIONS = {
            empathetic: { name: "ê°ì„± ë¦¬ë”", desc: "íƒ€ì¸ì˜ ë§ˆìŒì„ ì½ê³  ê³µê°í•˜ëŠ” ì²œë¶€ì ì¸ ëŠ¥ë ¥ì˜ ì†Œìœ ì" },
            comforting: { name: "íë§ ë©”ì´ì»¤", desc: "ì¡´ì¬ ìì²´ë¡œ ìœ„ë¡œê°€ ë˜ëŠ” ë§ˆìŒì˜ ì•ˆì‹ì²˜" },
            thoughtful: { name: "ê¹Šì´ ìˆëŠ” ì‚¬ìƒ‰ê°€", desc: "ì‹ ì¤‘í•˜ê³  ê¹Šì´ ìˆê²Œ ìƒê°í•˜ë©° ì§€í˜œë¡œìš´ ì¡°ì–¸ì„ ê±´ë„¤ëŠ” ì‚¬ëŒ" },
            healing: { name: "ë°”ì´ë¸Œ íë ˆì´í„°", desc: "ìƒí™©ì— ë§ëŠ” ì™„ë²½í•œ ë¶„ìœ„ê¸°ë¥¼ ì—°ì¶œí•˜ëŠ” ì„¼ìŠ¤ì˜ ë‹¬ì¸" },
            organized: { name: "í”Œë˜ë‹ ë§ˆìŠ¤í„°", desc: "ì²´ê³„ì ì´ê³  ì™„ë²½í•œ ê³„íšìœ¼ë¡œ ëª¨ë“  ê²ƒì„ ì„±ê³µìœ¼ë¡œ ì´ë„ëŠ” ê¸°íšì" },
            creative: { name: "ì•„ì´ë””ì–´ ë²¤ì²˜", desc: "ë‚¨ë“¤ì´ ìƒê°ì§€ ëª»í•œ ì°½ì˜ì  ì•„ì´ë””ì–´ë¡œ ìƒˆë¡œìš´ ê°€ì¹˜ë¥¼ ë§Œë“œëŠ” í˜ì‹ ê°€" },
            harmonious: { name: "íŒ€ ë°¸ëŸ°ì„œ", desc: "ì„œë¡œ ë‹¤ë¥¸ ì˜ê²¬ë“¤ì„ ì¡°í™”ë¡­ê²Œ ë§Œë“œëŠ” ê´€ê³„ì˜ ë§ˆì—ìŠ¤íŠ¸ë¡œ" },
            easygoing: { name: "í”Œë ‰ì„œë¸” ì†Œìš¸", desc: "ì–´ë–¤ ìƒí™©ì—ë„ ìœ ì—°í•˜ê²Œ ì ì‘í•˜ë©° ê¸ì •ì  ì—ë„ˆì§€ë¥¼ ë°œì‚°í•˜ëŠ” ììœ ë¡œìš´ ì˜í˜¼" },
            artistic: { name: "í¬ë¦¬ì—ì´í‹°ë¸Œ ë””ë ‰í„°", desc: "ê°ì„±ê³¼ ë¯¸ì  ê°ê°ìœ¼ë¡œ íŠ¹ë³„í•œ ìˆœê°„ì„ ë§Œë“¤ì–´ë‚´ëŠ” ì˜ˆìˆ ê°€" },
            social: { name: "ë„¤íŠ¸ì›Œí‚¹ ë§ˆìŠ¤í„°", desc: "ì‚¬ëŒë“¤ì„ ì—°ê²°í•˜ê³  ëª¨ìœ¼ëŠ” ì²œì¬ì ì¸ ì‚¬íšŒì  ëŠ¥ë ¥ì„ ê°€ì§„ ì»¤ë„¥í„°" },
            attentive: { name: "ë””í…Œì¼ ìŠ¤í˜ì…œë¦¬ìŠ¤íŠ¸", desc: "ìƒëŒ€ë°©ì˜ ì‘ì€ ë¶€ë¶„ê¹Œì§€ ì„¸ì‹¬í•˜ê²Œ ë°°ë ¤í•˜ëŠ” ê´€ì°°ì˜ ë‹¬ì¸" },
            entertaining: { name: "í€ í”„ë¡œë“€ì„œ", desc: "í‰ë²”í•œ ì¼ìƒì„ íŠ¹ë³„í•œ ì´ë²¤íŠ¸ë¡œ ë°”ê¾¸ëŠ” ì¬ë¯¸ì˜ ì—°ì¶œê°€" },
            generous: { name: "ê¸°ë¸Œ ì•¤ ê¸°ë¸Œ", desc: "ìì‹ ì˜ ê²ƒì„ ë‚˜ëˆ„ëŠ” ì¼ì— ì£¼ì €í•˜ì§€ ì•ŠëŠ” ë„ˆê·¸ëŸ¬ìš´ ë§ˆìŒì˜ ì†Œìœ ì" },
            practical: { name: "ì†”ë£¨ì…˜ íŒŒì¸ë”", desc: "ì–´ë–¤ ë¬¸ì œë“  í˜„ì‹¤ì ì´ê³  íš¨ê³¼ì ì¸ í•´ê²°ì±…ì„ ì°¾ì•„ë‚´ëŠ” ë¬¸ì œ í•´ê²°ì‚¬" },
            optimistic: { name: "í¬ì§€í‹°ë¸Œ ë°”ì´ëŸ¬ìŠ¤", desc: "ì–´ë–¤ ìƒí™©ë„ ë°ê²Œ ë°”ë¼ë³´ë©° ì£¼ë³€ì— í¬ë§ì„ ì „íŒŒí•˜ëŠ” ê¸ì • ì—ë„ˆì§€" },
            reliable: { name: "íŠ¸ëŸ¬ìŠ¤íŠ¸ ë¹Œë”", desc: "ì•½ì†ê³¼ ì‹ ë¢°ë¥¼ ì§€í‚¤ëŠ” ì¼ì— ìˆì–´ì„œëŠ” ì ˆëŒ€ì ì¸ ë¯¿ìŒì„ ì£¼ëŠ” ì‚¬ëŒ" },
            supportive: { name: "ì¹˜ì–´ë¦¬ë”© ìº¡í‹´", desc: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ë„ì „ê³¼ ì„±ì¥ì„ ì‘ì›í•˜ê³  ì§€ì§€í•˜ëŠ” ë“ ë“ í•œ ì„œí¬í„°" },
            wise: { name: "ì¸ì‚¬ì´íŠ¸ ë©”ì´ì»¤", desc: "ê¹Šì€ í†µì°°ë ¥ìœ¼ë¡œ ìƒí™©ì„ ë¶„ì„í•˜ê³  í˜„ëª…í•œ íŒë‹¨ì„ ë‚´ë¦¬ëŠ” ì§€í˜œì˜ ë³´ê³ " },
            adventurous: { name: "ì²´ì¸ì§€ ë©”ì´ì»¤", desc: "ìƒˆë¡œìš´ ë„ì „ì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³  ë³€í™”ë¥¼ ì¦ê¸°ëŠ” ëª¨í—˜ê°€ ì •ì‹ " },
            helpful: { name: "ì¸í¬ë©”ì´ì…˜ í—ˆë¸Œ", desc: "í•„ìš”í•œ ì •ë³´ì™€ ë„ì›€ì„ ì–¸ì œë‚˜ ì œê³µí•  ì¤€ë¹„ê°€ ë˜ì–´ìˆëŠ” ì§€ì‹ ê³µìœ ì" },
            cheerful: { name: "ë¬´ë“œ ì—… ìŠ¤í˜ì…œë¦¬ìŠ¤íŠ¸", desc: "ì–´ë–¤ ìˆœê°„ë„ ì¦ê²ê²Œ ë§Œë“œëŠ” íƒ€ê³ ë‚œ ë¶„ìœ„ê¸° ë©”ì´ì»¤" },
            positive: { name: "ë¸Œë¼ì´íŠ¸ ì—ë„ˆì§€", desc: "ë°ê³  ê¸ì •ì ì¸ ì‹œê°ìœ¼ë¡œ ì„¸ìƒì„ ë°”ë¼ë³´ëŠ” í–‡ì‚´ ê°™ì€ ì¡´ì¬" },
            caring: { name: "ì¼€ì–´ í…Œì´ì»¤", desc: "ë‹¤ë¥¸ ì‚¬ëŒì„ ëŒë³´ê³  ë°°ë ¤í•˜ëŠ” ì¼ì„ ìì—°ìŠ¤ëŸ½ê²Œ í•˜ëŠ” ë”°ëœ»í•œ ë§ˆìŒ" },
            philosophical: { name: "ë°¸ë¥˜ íë ˆì´í„°", desc: "ì‚¶ì˜ ë³¸ì§ˆì  ê°€ì¹˜ë¥¼ ì¤‘ì‹œí•˜ê³  ì˜ë¯¸ ìˆëŠ” ê´€ì ì„ ì œì‹œí•˜ëŠ” ì² í•™ì" },
            devoted: { name: "ë¡œì—´í‹° í¼ìŠ¤íŠ¸", desc: "ì†Œì¤‘í•œ ì‚¬ëŒì„ ìœ„í•´ì„œë¼ë©´ ëª¨ë“  ê²ƒì„ ì•„ë¼ì§€ ì•ŠëŠ” í—Œì‹ ì ì¸ ë§ˆìŒ" },
            affectionate: { name: "í•˜íŠ¸ ë©”ì‹ ì €", desc: "ë§ˆìŒì„ í‘œí˜„í•˜ê³  ì „ë‹¬í•˜ëŠ” ì¼ì— íŠ¹ë³„í•œ ì¬ëŠ¥ì„ ê°€ì§„ ê°ì • ì „ë‹¬ì" },
            therapeutic: { name: "ì†Œìš¸ ì¼€ì–´", desc: "ìì—°ìŠ¤ëŸ½ê³  ì¹˜ìœ ì ì¸ ë°©ë²•ìœ¼ë¡œ ë§ˆìŒì˜ ìƒì²˜ë¥¼ ëŒë³´ëŠ” ë§ˆìŒì˜ ì˜ì‚¬" },
            uplifting: { name: "ìŠ¤í”¼ë¦¿ ë¶€ìŠ¤í„°", desc: "ìì—°ìŠ¤ëŸ½ê²Œ ìƒëŒ€ë°©ì˜ ê¸°ë¶„ì„ ì¢‹ê²Œ ë§Œë“œëŠ” ì •ì‹ ì  ì—ë„ˆì§€ ì¶©ì „ê¸°" },
            responsive: { name: "ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ í”„ë¡œ", desc: "ë¹ ë¥´ê³  ì •í™•í•œ ì†Œí†µìœ¼ë¡œ ê´€ê³„ë¥¼ ì›í™œí•˜ê²Œ ë§Œë“œëŠ” ëŒ€í™”ì˜ ì „ë¬¸ê°€" },
            witty: { name: "ì„¼ìŠ¤ ì˜¤ë¸Œ íœ´ë¨¸", desc: "ì ˆë¬˜í•œ íƒ€ì´ë°ê³¼ ì„¼ìŠ¤ë¡œ ëª¨ë“  ìƒí™©ì„ ì¬ë¯¸ìˆê²Œ ë§Œë“œëŠ” ìœ ë¨¸ íë ˆì´í„°" },
            informative: { name: "ì¸í…”ë¦¬ì „ìŠ¤ í—ˆë¸Œ", desc: "ì²´ê³„ì ì´ê³  ìœ ìš©í•œ ì •ë³´ë¡œ ëª¨ë‘ì˜ ìƒí™œì„ í¸ë¦¬í•˜ê²Œ ë§Œë“œëŠ” ì •ë³´ ì „ë¬¸ê°€" },
            gentle: { name: "ì  í‹€ í„°ì¹˜", desc: "ë¶€ë“œëŸ½ê³  ë”°ëœ»í•œ ë§ í•œë§ˆë””ë¡œ ê¹Šì€ ê°ë™ì„ ì£¼ëŠ” ë§ˆìŒì˜ í„°ì¹˜" },
            mediator: { name: "í”¼ìŠ¤ ë©”ì´ì»¤", desc: "ê°ˆë“±ê³¼ ëŒ€ë¦½ì„ ì¡°í™”ë¡­ê²Œ í•´ê²°í•˜ëŠ” ê´€ê³„ ì¡°ì •ì˜ ì „ë¬¸ê°€" },
            understanding: { name: "ì— íŒ¨ì‹œ ë§ˆìŠ¤í„°", desc: "ëª¨ë“  ì…ì¥ì„ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” ë›°ì–´ë‚œ ì •ì„œì  ì§€ëŠ¥ì˜ ì†Œìœ ì" },
            peaceful: { name: "í•˜ëª¨ë‹ˆ íë ˆì´í„°", desc: "ìì—°ìŠ¤ëŸ½ê²Œ í‰í™”ë¡œìš´ ë¶„ìœ„ê¸°ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” ì•ˆì •ê°ì˜ ì œê³µì" },
            nurturing: { name: "ê·¸ë¡œìš°ìŠ¤ ì„œí¬í„°", desc: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ê³¼ ë°œì „ì„ ì„¸ì‹¬í•˜ê²Œ ëŒë³´ê³  í‚¤ì›Œì£¼ëŠ” ë§ˆìŒì˜ ì •ì›ì‚¬" },
            joyful: { name: "í•´í”¼ë‹ˆìŠ¤ ë°”ì´ëŸ¬ìŠ¤", desc: "ì£¼ë³€ ëª¨ë“  ì‚¬ëŒì—ê²Œ ê¸°ì¨ê³¼ ì¦ê±°ì›€ì„ ì „íŒŒí•˜ëŠ” í–‰ë³µì˜ ì „ë„ì‚¬" },
            inspiring: { name: "ëª¨í‹°ë² ì´ì…˜ ë¶€ìŠ¤í„°", desc: "ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì˜ê°ê³¼ ë™ê¸°ë¥¼ ë¶ˆëŸ¬ì¼ìœ¼í‚¤ëŠ” ì‚¶ì˜ ë©˜í† " },
            trustworthy: { name: "ì»¨í”¼ë˜ìŠ¤ ë¹Œë”", desc: "ì ˆëŒ€ì ì¸ ì‹ ë¢°ì™€ ë¯¿ìŒì„ ë°”íƒ•ìœ¼ë¡œ í•œ ê´€ê³„ì˜ ê¸°ë°˜ì„ ë§Œë“œëŠ” ì‚¬ëŒ" }
        };

        // ê²©ë ¤ ë©”ì‹œì§€
        const ENCOURAGEMENT_MESSAGES = [
            "ğŸŒ» ë™ë£Œë“¤ì´ ë‹¹ì‹ ì„ ì´ë ‡ê²Œ ìƒê°í•˜ê³  ìˆì—ˆë‹¤ë‹ˆ!<br>ì •ë§ ì‚¬ë‘ìŠ¤ëŸ½ê³  íŠ¹ë³„í•œ ì¡´ì¬ì‹œë„¤ìš” âœ¨",
            "ğŸˆ ì´ ê²°ê³¼ë¥¼ ë³´ë‹ˆ ë‹¹ì‹ ì´ ì–¼ë§ˆë‚˜ ì†Œì¤‘í•œ ì‚¬ëŒì¸ì§€<br>ë‹¤ì‹œ í•œë²ˆ ëŠë¼ê²Œ ë˜ì–´ìš” ğŸŒŸ",
            "ğŸŒˆ ë™ë£Œë“¤ì˜ ë”°ëœ»í•œ ì‹œì„ ì—ì„œ ë°œê²¬ëœ<br>ë‹¹ì‹ ì˜ ë¹›ë‚˜ëŠ” ëª¨ìŠµë“¤ì´ ì •ë§ ì•„ë¦„ë‹¤ì›Œìš” ğŸ’",
            "ğŸ¯ ì´ëŸ° í‰ê°€ë¥¼ ë°›ëŠ”ë‹¤ëŠ” ê±´<br>ë‹¹ì‹ ì´ ì–¼ë§ˆë‚˜ ë©‹ì§„ ì‚¬ëŒì¸ì§€ ë³´ì—¬ì£¼ëŠ” ê±°ì˜ˆìš”! ğŸ†"
        ];

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ (ì„±ëŠ¥ ìµœì í™” ë° ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”)
        const Utils = {
            generateSurveyId: (userName) => {
                try {
                    if (!userName || typeof userName !== 'string') {
                        throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤.');
                    }
                    const cleanName = userName.trim().slice(0, 50); // ê¸¸ì´ ì œí•œ
                    return btoa(encodeURIComponent(cleanName)).replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
                } catch (error) {
                    console.error('ì„¤ë¬¸ ID ìƒì„± ì˜¤ë¥˜:', error);
                    return btoa(encodeURIComponent('anonymous')).replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
                }
            },

            getUserFromUrl: () => {
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    const user = urlParams.get('user');
                    return user ? decodeURIComponent(user) : null;
                } catch (error) {
                    console.error('URL íŒŒë¼ë¯¸í„° íŒŒì‹± ì˜¤ë¥˜:', error);
                    return null;
                }
            },

            showScreen: (screenId) => {
                try {
                    // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
                    document.querySelectorAll('.screen').forEach(screen => {
                        screen.classList.remove('active');
                    });
                    
                    // ìš”ì²­ëœ í™”ë©´ í‘œì‹œ
                    const targetScreen = document.getElementById(screenId);
                    if (targetScreen) {
                        targetScreen.classList.add('active');
                        // ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ
                        setTimeout(() => {
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }, 100);
                    } else {
                        console.error('í™”ë©´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', screenId);
                    }
                } catch (error) {
                    console.error('í™”ë©´ ì „í™˜ ì˜¤ë¥˜:', error);
                }
            },

            // ë°°ì—´ ì„ê¸° í•¨ìˆ˜ (Fisher-Yates ì•Œê³ ë¦¬ì¦˜) - ì„±ëŠ¥ ìµœì í™”
            shuffleArray: (array) => {
                if (!Array.isArray(array)) return [];
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            },

            copyToClipboard: async (text) => {
                if (!text || typeof text !== 'string') {
                    console.error('ë³µì‚¬í•  í…ìŠ¤íŠ¸ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    return false;
                }

                try {
                    // í˜„ëŒ€ì ì¸ Clipboard API ì‹œë„
                    if (navigator.clipboard && window.isSecureContext) {
                        await navigator.clipboard.writeText(text);
                        return true;
                    } else {
                        // Fallback ë°©ë²•
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        textArea.style.position = 'fixed';
                        textArea.style.left = '-999999px';
                        textArea.style.top = '-999999px';
                        textArea.style.opacity = '0';
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();
                        
                        const result = document.execCommand('copy');
                        document.body.removeChild(textArea);
                        return result;
                    }
                } catch (err) {
                    console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                    return false;
                }
            },

            showNotification: (message) => {
                if (!message) return;
                
                try {
                    // ëª¨ë°”ì¼ì—ì„œ ë” ë‚˜ì€ ì•Œë¦¼ì„ ìœ„í•œ ì²˜ë¦¬
                    if ('vibrate' in navigator) {
                        navigator.vibrate(100);
                    }
                    alert(message);
                } catch (error) {
                    console.error('ì•Œë¦¼ í‘œì‹œ ì˜¤ë¥˜:', error);
                }
            },

            // ë°ì´í„° ê²€ì¦ ìœ í‹¸ë¦¬í‹°
            validateSurveyData: (survey) => {
                return survey && 
                       typeof survey === 'object' && 
                       survey.name && 
                       Array.isArray(survey.responses) && 
                       typeof survey.traits === 'object';
            },

            // ì•ˆì „í•œ DOM ìš”ì†Œ ì ‘ê·¼
            safeGetElement: (id) => {
                try {
                    return document.getElementById(id);
                } catch (error) {
                    console.error(`ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${id}`, error);
                    return null;
                }
            },

            // ë©”ëª¨ë¦¬ ì •ë¦¬
            cleanup: () => {
                try {
                    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬ (í•„ìš”ì‹œ)
                    window.removeEventListener('beforeunload', AppState.beforeUnloadHandler);
                } catch (error) {
                    console.error('ì •ë¦¬ ì‘ì—… ì˜¤ë¥˜:', error);
                }
            }
        };

        // í™”ë©´ ê´€ë¦¬ì
        const ScreenManager = {
            showSetup: () => {
                Utils.showScreen('setupScreen');
            },

            showSurvey: (userName) => {
                document.getElementById('targetName').innerHTML = `ğŸ’ ${decodeURIComponent(userName)} ë‹˜`;
                
                // ì„¤ë¬¸ ë°ì´í„° ë¯¸ë¦¬ ìƒì„±
                const surveyId = Utils.generateSurveyId(userName);
                if (!AppState.surveys[surveyId]) {
                    AppState.surveys[surveyId] = {
                        name: userName,
                        responses: [],
                        traits: {},
                        createdAt: new Date().toISOString()
                    };
                }
                AppState.currentUser = surveyId;
                
                Utils.showScreen('surveyScreen');
                SurveyManager.startSurvey();
            },

            showResults: (surveyId, userName) => {
                Utils.showScreen('resultScreen');
                ResultManager.displayResults(surveyId, userName);
            },

            showSurveyComplete: (surveyId) => {
                Utils.showScreen('surveyCompleteScreen');
                SurveyCompleteManager.displayComplete(surveyId);
            },

            viewResults: (userName) => {
                const surveyId = Utils.generateSurveyId(userName);
                if (AppState.surveys[surveyId] && AppState.surveys[surveyId].responses.length >= AppState.minParticipants) {
                    this.showResults(surveyId, userName);
                } else {
                    const currentCount = AppState.surveys[surveyId] ? AppState.surveys[surveyId].responses.length : 0;
                    const needed = AppState.minParticipants - currentCount;
                    Utils.showNotification(`ê²°ê³¼ í™•ì¸ì„ ìœ„í•´ ${needed}ëª…ì´ ë” ì°¸ì—¬í•´ì•¼ í•©ë‹ˆë‹¤.\n\ní˜„ì¬ ${currentCount}ëª…ì´ ì°¸ì—¬í–ˆì–´ìš”.\në§í¬ë¥¼ ë” ë§ì´ ê³µìœ í•´ì£¼ì„¸ìš”!`);
                }
            }
        };

        // ì„¤ë¬¸ ê´€ë¦¬ì (ì—ëŸ¬ ì²˜ë¦¬ ë° ì„±ëŠ¥ ìµœì í™”)
        const SurveyManager = {
            startSurvey() {
                try {
                    AppState.currentQuestionIndex = 0;
                    AppState.answers = [];
                    AppState.isAnswering = false;
                    this.showCurrentQuestion();
                } catch (error) {
                    console.error('ì„¤ë¬¸ ì‹œì‘ ì˜¤ë¥˜:', error);
                    Utils.showNotification('ì„¤ë¬¸ì„ ì‹œì‘í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            },

            showCurrentQuestion() {
                try {
                    if (AppState.currentQuestionIndex >= QUESTIONS.length) {
                        console.error('ì˜ëª»ëœ ì§ˆë¬¸ ì¸ë±ìŠ¤:', AppState.currentQuestionIndex);
                        return;
                    }

                    const question = QUESTIONS[AppState.currentQuestionIndex];
                    const questionTitle = Utils.safeGetElement('questionTitle');
                    const optionsContainer = Utils.safeGetElement('optionsContainer');
                    
                    if (!questionTitle || !optionsContainer) {
                        console.error('í•„ìˆ˜ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }

                    questionTitle.innerHTML = question.text;
                    optionsContainer.innerHTML = '';

                    // ë³´ê¸° ìˆœì„œë¥¼ ëœë¤í•˜ê²Œ ì„ê¸°
                    const shuffledOptions = Utils.shuffleArray(question.options);

                    // DocumentFragment ì‚¬ìš©ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”
                    const fragment = document.createDocumentFragment();

                    shuffledOptions.forEach((option) => {
                        const optionCard = document.createElement('div');
                        optionCard.className = 'option-card';
                        optionCard.innerHTML = `
                            <div class="option-content">
                                <span class="option-emoji">${option.emoji}</span>
                                <span class="option-text">${option.text}</span>
                            </div>
                        `;
                        optionCard.addEventListener('click', () => this.selectOption(option, optionCard), { once: true });
                        fragment.appendChild(optionCard);
                    });

                    optionsContainer.appendChild(fragment);
                    this.updateProgress();
                } catch (error) {
                    console.error('ì§ˆë¬¸ í‘œì‹œ ì˜¤ë¥˜:', error);
                    Utils.showNotification('ì§ˆë¬¸ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            },

            selectOption(selectedOption, element) {
                if (AppState.isAnswering || !selectedOption || !element) return;
                
                try {
                    AppState.isAnswering = true;
                    
                    // ì‹œê°ì  í”¼ë“œë°±
                    document.querySelectorAll('.option-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    element.classList.add('selected');

                    // ë‹µë³€ ì €ì¥ (ì„ íƒëœ ì˜µì…˜ì˜ trait ì €ì¥)
                    AppState.answers[AppState.currentQuestionIndex] = selectedOption.trait;

                    // ë¡œë”© í™”ë©´ í‘œì‹œ
                    const loadingScreen = Utils.safeGetElement('loadingScreen');
                    if (loadingScreen) {
                        loadingScreen.style.display = 'block';
                    }

                    // ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ì§„í–‰ (ë”œë ˆì´ ì‹œê°„ ë‹¨ì¶•: 500ms)
                    setTimeout(() => {
                        if (loadingScreen) {
                            loadingScreen.style.display = 'none';
                        }
                        this.nextQuestion();
                        AppState.isAnswering = false;
                    }, 500);
                } catch (error) {
                    console.error('ì˜µì…˜ ì„ íƒ ì˜¤ë¥˜:', error);
                    AppState.isAnswering = false;
                    Utils.showNotification('ë‹µë³€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            },

            nextQuestion() {
                try {
                    AppState.currentQuestionIndex++;
                    
                    if (AppState.currentQuestionIndex < QUESTIONS.length) {
                        this.showCurrentQuestion();
                    } else {
                        this.submitSurvey();
                    }
                } catch (error) {
                    console.error('ë‹¤ìŒ ì§ˆë¬¸ ì§„í–‰ ì˜¤ë¥˜:', error);
                    Utils.showNotification('ì„¤ë¬¸ ì§„í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            },

            updateProgress() {
                try {
                    const progress = ((AppState.currentQuestionIndex + 1) / QUESTIONS.length) * 100;
                    const progressFill = Utils.safeGetElement('progressFill');
                    const progressText = Utils.safeGetElement('progressText');
                    
                    if (progressFill) {
                        progressFill.style.width = `${progress}%`;
                    }
                    if (progressText) {
                        progressText.textContent = `${AppState.currentQuestionIndex + 1}/${QUESTIONS.length} ì§ˆë¬¸`;
                    }
                } catch (error) {
                    console.error('ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
                }
            },

            submitSurvey() {
                try {
                    const surveyId = AppState.currentUser;
                    
                    if (!surveyId) {
                        console.error('ì„¤ë¬¸ IDê°€ ì—†ìŠµë‹ˆë‹¤.');
                        Utils.showNotification('ì„¤ë¬¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }

                    // ì„¤ë¬¸ì´ ì—†ìœ¼ë©´ ìƒì„±
                    if (!AppState.surveys[surveyId]) {
                        const userName = Utils.getUserFromUrl();
                        if (!userName) {
                            console.error('ì‚¬ìš©ì ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            return;
                        }
                        
                        AppState.surveys[surveyId] = {
                            name: userName,
                            responses: [],
                            traits: {},
                            createdAt: new Date().toISOString()
                        };
                    }

                    // ì‘ë‹µ ì €ì¥
                    AppState.surveys[surveyId].responses.push({
                        answers: [...AppState.answers], // ë°°ì—´ ë³µì‚¬
                        timestamp: new Date().toISOString()
                    });

                    // íŠ¹ì„±ë³„ ì§‘ê³„
                    AppState.answers.forEach(trait => {
                        if (trait && typeof trait === 'string') {
                            if (!AppState.surveys[surveyId].traits[trait]) {
                                AppState.surveys[surveyId].traits[trait] = 0;
                            }
                            AppState.surveys[surveyId].traits[trait]++;
                        }
                    });

                    // ì„¤ë¬¸ ì™„ë£Œ í™”ë©´ìœ¼ë¡œ ì´ë™
                    ScreenManager.showSurveyComplete(surveyId);
                } catch (error) {
                    console.error('ì„¤ë¬¸ ì œì¶œ ì˜¤ë¥˜:', error);
                    Utils.showNotification('ì„¤ë¬¸ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }
        };

        // ì„¤ë¬¸ ì™„ë£Œ ê´€ë¦¬ì
        const SurveyCompleteManager = {
            displayComplete: (surveyId) => {
                const survey = AppState.surveys[surveyId];
                if (survey) {
                    document.getElementById('completeTargetName').textContent = survey.name;
                    this.updateParticipantCount(survey);
                }
            },

            updateParticipantCount: (survey) => {
                const participantCount = survey.responses.length;
                const remaining = Math.max(0, AppState.minParticipants - participantCount);
                
                // ì°¸ì—¬ì ìˆ˜ ì—…ë°ì´íŠ¸
                document.querySelector('.count-number').textContent = participantCount;
                document.getElementById('remainingCount').textContent = remaining;
                
                // ê°œë´‰ ì¡°ê±´ í™•ì¸
                const viewResultsBtn = document.getElementById('viewResultsBtn');
                const countDescription = document.querySelector('.count-description');
                
                if (participantCount >= AppState.minParticipants) {
                    viewResultsBtn.style.display = 'block';
                    countDescription.innerHTML = 'ğŸ‰ ê²°ê³¼ ê°œë´‰ ì¡°ê±´ì´ ì¶©ì¡±ë˜ì—ˆìŠµë‹ˆë‹¤!';
                    countDescription.style.color = '#10b981';
                    countDescription.style.fontWeight = '600';
                } else {
                    viewResultsBtn.style.display = 'none';
                    countDescription.innerHTML = `ê²°ê³¼ ê°œë´‰ê¹Œì§€ <span>${remaining}</span>ëª… ë” í•„ìš”í•´ìš”`;
                }
            }
        };

        // ê²°ê³¼ ê´€ë¦¬ì
        const ResultManager = {
            displayResults: (surveyId, userName) => {
                const survey = AppState.surveys[surveyId] || {
                    name: userName,
                    responses: [],
                    traits: {}
                };
                
                const totalResponses = survey.responses.length;

                // ê°œë´‰ ì¡°ê±´ í™•ì¸
                if (totalResponses < AppState.minParticipants) {
                    Utils.showNotification(`ê²°ê³¼ í™•ì¸ì„ ìœ„í•´ ${AppState.minParticipants - totalResponses}ëª…ì´ ë” ì°¸ì—¬í•´ì•¼ í•©ë‹ˆë‹¤.\n\në§í¬ë¥¼ ë” ë§ì´ ê³µìœ í•´ì£¼ì„¸ìš”!`);
                    return;
                }

                // í†µê³„ í‘œì‹œ
                this.displayStats(totalResponses, userName);
                
                // ìƒì„¸ ê²°ê³¼ ë³´ê³ ì„œ ìƒì„±
                this.generateDetailedReport(survey, userName);
                
                // ê³µìœ  ë§í¬ ì„¤ì •
                this.setupSharing(userName);
            },

            displayStats: (totalResponses, userName) => {
                const statsContainer = document.getElementById('resultStats');
                statsContainer.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${totalResponses}</div>
                        <div class="stat-label">ì°¸ì—¬ì</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">âœ¨</div>
                        <div class="stat-label">${userName}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">ğŸ“Š</div>
                        <div class="stat-label">ë¶„ì„ ì™„ë£Œ</div>
                    </div>
                `;
            },

            generateDetailedReport: (survey, userName) => {
                const resultContainer = document.getElementById('resultContent');
                const totalResponses = survey.responses.length;
                
                if (totalResponses === 0) {
                    resultContainer.innerHTML = this.getEmptyResultHTML();
                    return;
                }

                // ìƒìœ„ íŠ¹ì„± ë¶„ì„
                const sortedTraits = Object.entries(survey.traits)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5);

                const topTrait = sortedTraits[0];
                const topTraitInfo = TRAIT_DESCRIPTIONS[topTrait[0]];
                
                resultContainer.innerHTML = `
                    <div class="detailed-report">
                        <div class="report-header">
                            <h2 class="report-title">${userName}ë‹˜ì˜<br>ì„±í–¥ ë¶„ì„ ë³´ê³ ì„œ</h2>
                            <p class="report-subtitle">
                                ${totalResponses}ëª…ì˜ ì†Œì¤‘í•œ ë¶„ë“¤ì´ ì „í•´ì¤€<br>
                                ì§„ì‹¬ì–´ë¦° ë§ˆìŒì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤
                            </p>
                        </div>

                        <div class="personality-summary">
                            <h3 class="summary-title">ë‹¹ì‹ ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ í‘œí˜„í•˜ë©´</h3>
                            <p class="summary-text">
                                "${this.generatePersonalitySummary(sortedTraits, userName)}"
                            </p>
                        </div>

                        <div class="trait-analysis">
                            <h3 class="analysis-title">ì¹œêµ¬ë“¤ì´ ë°œê²¬í•œ ë‹¹ì‹ ì˜ íŠ¹ë³„í•œ ë©´ë“¤</h3>
                            <div class="top-traits">
                                ${sortedTraits.map(([trait, count]) => {
                                    const percentage = Math.round((count / totalResponses) * 100);
                                    const traitInfo = TRAIT_DESCRIPTIONS[trait];
                                    return `
                                        <div class="trait-item-detailed">
                                            <div class="trait-header">
                                                <div class="trait-name-detailed">${traitInfo.name}</div>
                                                <div class="trait-percentage-detailed">${percentage}%</div>
                                            </div>
                                            <div class="trait-description-detailed">${traitInfo.desc}</div>
                                            <div class="trait-meaning">
                                                ${this.getTraitMeaning(trait, percentage)}
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="closing-message">
                            <h3 class="closing-title">ë§ˆìŒì„ ì „í•˜ë©°</h3>
                            <p class="closing-text">
                                ${this.generateClosingMessage(userName, totalResponses)}
                            </p>
                        </div>
                    </div>
                `;
            },

            generatePersonalitySummary: (traits, userName) => {
                const summaries = {
                    empathetic: `${userName}ë‹˜ì€ ë§ˆìŒì„ ì½ëŠ” ê°ì„±ì˜ ë§ˆë²•ì‚¬ì…ë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ ì‘ì€ ê°ì • ë³€í™”ë„ ë†“ì¹˜ì§€ ì•Šê³ , ë”°ëœ»í•œ ê³µê°ìœ¼ë¡œ ë§ˆìŒì˜ ë‹¤ë¦¬ë¥¼ ë†“ëŠ” ë¶„ì´ì—ìš”.`,
                    comforting: `${userName}ë‹˜ì€ ì„¸ìƒì˜ ëª¨ë“  ìƒì²˜ë¥¼ ì–´ë£¨ë§Œì§ˆ ìˆ˜ ìˆëŠ” ì¹˜ìœ ì˜ ì†ê¸¸ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤. ê·¸ì € ê³ì— ìˆëŠ” ê²ƒë§Œìœ¼ë¡œë„ í° ìœ„ë¡œê°€ ë˜ëŠ” íŠ¹ë³„í•œ ì¡´ì¬ì…ë‹ˆë‹¤.`,
                    thoughtful: `${userName}ë‹˜ì€ ê¹Šì´ ìˆëŠ” ì‚¬ê³ ì™€ ì‹ ì¤‘í•¨ìœ¼ë¡œ ì£¼ë³€ì„ ëŒë³´ëŠ” ì§€í˜œë¡œìš´ ë¶„ì…ë‹ˆë‹¤. ì„±ê¸‰í•œ íŒë‹¨ë³´ë‹¤ëŠ” ê¹Šì€ ì„±ì°°ë¡œ ê°€ì¥ ì¢‹ì€ ë‹µì„ ì°¾ì•„ë‚´ëŠ” ì‚¬ëŒì´ì—ìš”.`,
                    healing: `${userName}ë‹˜ì€ ìƒí™©ì— ë§ëŠ” ì™„ë²½í•œ ë¶„ìœ„ê¸°ë¥¼ ì—°ì¶œí•˜ëŠ” ê°ì„± íë ˆì´í„°ì…ë‹ˆë‹¤. ì–´ë–¤ ìˆœê°„ì´ë“  ê·¸ì— ì–´ìš¸ë¦¬ëŠ” íŠ¹ë³„í•œ ë¬´ë“œë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” ì„¼ìŠ¤ì˜ ì†Œìœ ìì˜ˆìš”.`,
                    organized: `${userName}ë‹˜ì€ ì™„ë²½í•œ ê³„íšê³¼ ì²´ê³„ë¡œ ëª¨ë“  ê²ƒì„ ì„±ê³µìœ¼ë¡œ ì´ë„ëŠ” ê¸°íšì˜ ë§ˆì—ìŠ¤íŠ¸ë¡œì…ë‹ˆë‹¤. ë¹ˆí‹ˆì—†ëŠ” ì¤€ë¹„ì™€ ì„¸ì‹¬í•œ ë°°ë ¤ë¡œ ì‹ ë¢°ë¥¼ ìŒ“ì•„ê°€ëŠ” ë¶„ì´ì—ìš”.`,
                    creative: `${userName}ë‹˜ì€ ì„¸ìƒì„ ìƒˆë¡œìš´ ì‹œê°ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ì°½ì˜ì  ì‚¬ê³ ì˜ ê°œì²™ìì…ë‹ˆë‹¤. í‰ë²”í•œ ì¼ìƒì—ì„œë„ íŠ¹ë³„í•œ ì•„ì´ë””ì–´ë¥¼ ë°œê²¬í•´ë‚´ëŠ” í˜ì‹ ê°€ì˜ DNAë¥¼ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    harmonious: `${userName}ë‹˜ì€ ì„œë¡œ ë‹¤ë¥¸ ë§ˆìŒë“¤ì„ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ê´€ê³„ì˜ ë§ˆì—ìŠ¤íŠ¸ë¡œì…ë‹ˆë‹¤. ê°ˆë“±ê³¼ ëŒ€ë¦½ì„ ì¡°í™”ë¡­ê²Œ í•´ê²°í•˜ë©°, ëª¨ë‘ê°€ í•¨ê»˜ ì›ƒì„ ìˆ˜ ìˆëŠ” ë¶„ìœ„ê¸°ë¥¼ ë§Œë“œëŠ” ë¶„ì´ì—ìš”.`,
                    easygoing: `${userName}ë‹˜ì€ ììœ ë¡œìš´ ì˜í˜¼ìœ¼ë¡œ ì–´ë–¤ ìƒí™©ì—ë„ ìœ ì—°í•˜ê²Œ ì ì‘í•˜ëŠ” ë¶„ì…ë‹ˆë‹¤. ê²½ì§ë˜ì§€ ì•ŠëŠ” ë§ˆìŒê°€ì§ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ í¸ì•ˆí•¨ì„ ì„ ì‚¬í•˜ëŠ” íŠ¹ë³„í•œ ë§¤ë ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    artistic: `${userName}ë‹˜ì€ ì¼ìƒ ì†ì—ì„œë„ ì•„ë¦„ë‹¤ì›€ì„ ë°œê²¬í•˜ê³  ì°½ì¡°í•˜ëŠ” ì˜ˆìˆ ê°€ì  ê°ì„±ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ì†ê¸¸ì´ ë‹¿ëŠ” ëª¨ë“  ê²ƒì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“œëŠ” ì°½ì¡°ì  ì¬ëŠ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    social: `${userName}ë‹˜ì€ ì‚¬ëŒë“¤ì„ ì—°ê²°í•˜ê³  ëª¨ìœ¼ëŠ” ì²œì¬ì ì¸ ì‚¬íšŒì  ëŠ¥ë ¥ì„ ê°€ì§„ ì»¤ë„¥í„°ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ½ê²Œ ê´€ê³„ì˜ ì¤‘ì‹¬ì´ ë˜ì–´ ëª¨ë‘ë¥¼ í•˜ë‚˜ë¡œ ë§Œë“œëŠ” íŠ¹ë³„í•œ í˜ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    attentive: `${userName}ë‹˜ì€ ìƒëŒ€ë°©ì˜ ì‘ì€ ë¶€ë¶„ê¹Œì§€ ì„¸ì‹¬í•˜ê²Œ ë°°ë ¤í•˜ëŠ” ê´€ì°°ì˜ ë‹¬ì¸ì…ë‹ˆë‹¤. ë‚¨ë“¤ì´ ë†“ì¹˜ëŠ” ë””í…Œì¼ê¹Œì§€ ì±™ê¸°ëŠ” ë”°ëœ»í•œ ë§ˆìŒì”¨ë¡œ ëª¨ë‘ì—ê²Œ ê¹Šì€ ê°ë™ì„ ì£¼ëŠ” ë¶„ì´ì—ìš”.`,
                    entertaining: `${userName}ë‹˜ì€ í‰ë²”í•œ ì¼ìƒì„ íŠ¹ë³„í•œ ì´ë²¤íŠ¸ë¡œ ë°”ê¾¸ëŠ” ì¬ë¯¸ì˜ ì—°ì¶œê°€ì…ë‹ˆë‹¤. ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ì™€ ìœ ì¾Œí•œ ì—ë„ˆì§€ë¡œ ëª¨ë“  ìˆœê°„ì„ ì¦ê±°ì›€ìœ¼ë¡œ ë¬¼ë“¤ì´ëŠ” ë§ˆë²•ì‚¬ì˜ˆìš”.`,
                    generous: `${userName}ë‹˜ì€ ìì‹ ì˜ ê²ƒì„ ë‚˜ëˆ„ëŠ” ì¼ì— ì£¼ì €í•˜ì§€ ì•ŠëŠ” ë„ˆê·¸ëŸ¬ìš´ ë§ˆìŒì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ì§„ì •í•œ ë‚˜ëˆ”ì˜ ì˜ë¯¸ë¥¼ ì‹¤ì²œìœ¼ë¡œ ë³´ì—¬ì£¼ë©° ëª¨ë‘ì—ê²Œ ì˜¨ê¸°ë¥¼ ì „í•˜ëŠ” ë¶„ì´ì—ìš”.`,
                    practical: `${userName}ë‹˜ì€ ì–´ë–¤ ë¬¸ì œë“  í˜„ì‹¤ì ì´ê³  íš¨ê³¼ì ì¸ í•´ê²°ì±…ì„ ì°¾ì•„ë‚´ëŠ” ë¬¸ì œ í•´ê²°ì‚¬ì…ë‹ˆë‹¤. íƒì›”í•œ íŒë‹¨ë ¥ê³¼ ì‹¤í–‰ë ¥ìœ¼ë¡œ ëª¨ë“  ìƒí™©ì„ ìŠ¬ê¸°ë¡­ê²Œ í—¤ì³ë‚˜ê°€ëŠ” ëŠ¥ë ¥ìì˜ˆìš”.`,
                    optimistic: `${userName}ë‹˜ì€ ì–´ë–¤ ìƒí™©ë„ ë°ê²Œ ë°”ë¼ë³´ë©° ì£¼ë³€ì— í¬ë§ì„ ì „íŒŒí•˜ëŠ” ê¸ì • ì—ë„ˆì§€ì˜ ì›ì²œì…ë‹ˆë‹¤. ë¶ˆê°€ëŠ¥í•´ ë³´ì´ëŠ” ì¼ë„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” ë¯¿ìŒì˜ í˜ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    reliable: `${userName}ë‹˜ì€ ì•½ì†ê³¼ ì‹ ë¢°ë¥¼ ìƒëª…ì²˜ëŸ¼ ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ë¯¿ìŒì˜ ê¸°ë‘¥ì…ë‹ˆë‹¤. ì–´ë–¤ ìƒí™©ì—ì„œë„ í”ë“¤ë¦¬ì§€ ì•ŠëŠ” ì¼ê´€ì„±ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ì•ˆì •ê°ì„ ì£¼ëŠ” ì¡´ì¬ì˜ˆìš”.`,
                    supportive: `${userName}ë‹˜ì€ ë‹¤ë¥¸ ì‚¬ëŒì˜ ë„ì „ê³¼ ì„±ì¥ì„ ì‘ì›í•˜ê³  ì§€ì§€í•˜ëŠ” ë“ ë“ í•œ ì„œí¬í„°ì…ë‹ˆë‹¤. ì¡°ê±´ ì—†ëŠ” ê²©ë ¤ì™€ ì‘ì›ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒë“¤ì´ ë” ë†’ì´ ë‚  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¶„ì´ì—ìš”.`,
                    wise: `${userName}ë‹˜ì€ ê¹Šì€ í†µì°°ë ¥ìœ¼ë¡œ ìƒí™©ì„ ë¶„ì„í•˜ê³  í˜„ëª…í•œ íŒë‹¨ì„ ë‚´ë¦¬ëŠ” ì§€í˜œì˜ ë³´ê³ ì…ë‹ˆë‹¤. ì¸ìƒì˜ ê²½í—˜ê³¼ ì„±ì°°ì´ ë§Œë“¤ì–´ë‚¸ ê¹Šì´ ìˆëŠ” ì¡°ì–¸ìœ¼ë¡œ ë§ì€ ì´ë“¤ì—ê²Œ ê¸¸ì¡ì´ê°€ ë˜ëŠ” ë¶„ì´ì—ìš”.`,
                    adventurous: `${userName}ë‹˜ì€ ìƒˆë¡œìš´ ë„ì „ì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³  ë³€í™”ë¥¼ ì¦ê¸°ëŠ” ëª¨í—˜ê°€ ì •ì‹ ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ìš©ê¸° ìˆëŠ” ì²« ê±¸ìŒìœ¼ë¡œ ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì„ ì—´ì–´ê°€ëŠ” ê°œì²™ìì˜ ë§ˆìŒì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    helpful: `${userName}ë‹˜ì€ í•„ìš”í•œ ì •ë³´ì™€ ë„ì›€ì„ ì–¸ì œë‚˜ ì œê³µí•  ì¤€ë¹„ê°€ ë˜ì–´ìˆëŠ” ì§€ì‹ ê³µìœ ìì…ë‹ˆë‹¤. ìì‹ ì˜ ê²½í—˜ê³¼ ì§€ì‹ì„ ì•„ë‚Œì—†ì´ ë‚˜ëˆ„ë©° ëª¨ë‘ì˜ ì„±ì¥ì— ê¸°ì—¬í•˜ëŠ” ì†Œì¤‘í•œ ì¡´ì¬ì˜ˆìš”.`,
                    cheerful: `${userName}ë‹˜ì€ ì–´ë–¤ ìˆœê°„ë„ ì¦ê²ê²Œ ë§Œë“œëŠ” íƒ€ê³ ë‚œ ë¶„ìœ„ê¸° ë©”ì´ì»¤ì…ë‹ˆë‹¤. ë°ê³  ìœ ì¾Œí•œ ì—ë„ˆì§€ë¡œ ì£¼ë³€ì„ í™˜í•˜ê²Œ ë°íˆë©° ëª¨ë“  ì´ì˜ í•˜ë£¨ë¥¼ íŠ¹ë³„í•˜ê²Œ ë§Œë“œëŠ” í–‡ì‚´ ê°™ì€ ë¶„ì´ì—ìš”.`,
                    positive: `${userName}ë‹˜ì€ ë°ê³  ê¸ì •ì ì¸ ì‹œê°ìœ¼ë¡œ ì„¸ìƒì„ ë°”ë¼ë³´ëŠ” í–‡ì‚´ ê°™ì€ ì¡´ì¬ì…ë‹ˆë‹¤. ì–´ë ¤ìš´ ìƒí™©ì—ì„œë„ í¬ë§ì„ ìƒì§€ ì•ŠëŠ” ê°•ì¸í•œ ë§ˆìŒìœ¼ë¡œ ëª¨ë‘ì—ê²Œ ìš©ê¸°ë¥¼ ì£¼ëŠ” ë¶„ì´ì—ìš”.`,
                    caring: `${userName}ë‹˜ì€ ë‹¤ë¥¸ ì‚¬ëŒì„ ëŒë³´ê³  ë°°ë ¤í•˜ëŠ” ì¼ì„ ìì—°ìŠ¤ëŸ½ê²Œ í•˜ëŠ” ë”°ëœ»í•œ ë§ˆìŒì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ì‘ì€ ê´€ì‹¬ê³¼ ì„¸ì‹¬í•œ ë°°ë ¤ë¡œ ì£¼ë³€ ì‚¬ëŒë“¤ì˜ ë§ˆìŒì„ ë”°ëœ»í•˜ê²Œ ì–´ë£¨ë§Œì§€ëŠ” ë¶„ì´ì—ìš”.`,
                    philosophical: `${userName}ë‹˜ì€ ì‚¶ì˜ ë³¸ì§ˆì  ê°€ì¹˜ë¥¼ ì¤‘ì‹œí•˜ê³  ì˜ë¯¸ ìˆëŠ” ê´€ì ì„ ì œì‹œí•˜ëŠ” ì² í•™ìì  ì‚¬ê³ ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ê¹Šì´ ìˆëŠ” ì„±ì°°ê³¼ ì§€í˜œë¡œìš´ ì‹œê°ìœ¼ë¡œ ì¸ìƒì˜ ì§„ì •í•œ ì˜ë¯¸ë¥¼ íƒêµ¬í•˜ëŠ” ë¶„ì´ì—ìš”.`,
                    devoted: `${userName}ë‹˜ì€ ì†Œì¤‘í•œ ì‚¬ëŒì„ ìœ„í•´ì„œë¼ë©´ ëª¨ë“  ê²ƒì„ ì•„ë¼ì§€ ì•ŠëŠ” í—Œì‹ ì ì¸ ë§ˆìŒì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ì§„ì •í•œ ì‚¬ë‘ê³¼ ìš°ì •ì´ ë¬´ì—‡ì¸ì§€ë¥¼ í–‰ë™ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ì¶©ì‹¤í•œ ë²—ì´ì—ìš”.`,
                    affectionate: `${userName}ë‹˜ì€ ë§ˆìŒì„ í‘œí˜„í•˜ê³  ì „ë‹¬í•˜ëŠ” ì¼ì— íŠ¹ë³„í•œ ì¬ëŠ¥ì„ ê°€ì§„ ê°ì • ì „ë‹¬ìì…ë‹ˆë‹¤. ì§„ì‹¬ì–´ë¦° ì• ì •ê³¼ ë”°ëœ»í•œ í‘œí˜„ìœ¼ë¡œ ê´€ê³„ì˜ ê¹Šì´ë¥¼ ë”í•´ê°€ëŠ” ì†Œì¤‘í•œ ì¡´ì¬ì˜ˆìš”.`,
                    therapeutic: `${userName}ë‹˜ì€ ìì—°ìŠ¤ëŸ½ê³  ì¹˜ìœ ì ì¸ ë°©ë²•ìœ¼ë¡œ ë§ˆìŒì˜ ìƒì²˜ë¥¼ ëŒë³´ëŠ” ë§ˆìŒì˜ ì˜ì‚¬ì…ë‹ˆë‹¤. íŠ¹ë³„í•œ ê¸°ìˆ ì´ ì•„ë‹Œ ì§„ì‹¬ì–´ë¦° ê´€ì‹¬ê³¼ ë”°ëœ»í•¨ìœ¼ë¡œ ì¹˜ìœ ì˜ í˜ì„ ë°œíœ˜í•˜ëŠ” ë¶„ì´ì—ìš”.`,
                    uplifting: `${userName}ë‹˜ì€ ìì—°ìŠ¤ëŸ½ê²Œ ìƒëŒ€ë°©ì˜ ê¸°ë¶„ì„ ì¢‹ê²Œ ë§Œë“œëŠ” ì •ì‹ ì  ì—ë„ˆì§€ ì¶©ì „ê¸°ì…ë‹ˆë‹¤. ê¸ì •ì ì¸ ë°”ì´ë¸Œì™€ ê²©ë ¤ì˜ ë§ë¡œ ëª¨ë“  ì´ì˜ ë§ˆìŒì„ ë°ê²Œ ë§Œë“œëŠ” íŠ¹ë³„í•œ ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    responsive: `${userName}ë‹˜ì€ ë¹ ë¥´ê³  ì •í™•í•œ ì†Œí†µìœ¼ë¡œ ê´€ê³„ë¥¼ ì›í™œí•˜ê²Œ ë§Œë“œëŠ” ëŒ€í™”ì˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ ë§ì— ì§„ì‹¬ìœ¼ë¡œ ê·€ ê¸°ìš¸ì´ê³  ì ì ˆí•œ ë°˜ì‘ì„ ë³´ì´ëŠ” ì†Œí†µì˜ ë‹¬ì¸ì´ì—ìš”.`,
                    witty: `${userName}ë‹˜ì€ ì ˆë¬˜í•œ íƒ€ì´ë°ê³¼ ì„¼ìŠ¤ë¡œ ëª¨ë“  ìƒí™©ì„ ì¬ë¯¸ìˆê²Œ ë§Œë“œëŠ” ìœ ë¨¸ íë ˆì´í„°ì…ë‹ˆë‹¤. ì§€ì ì´ë©´ì„œë„ ì¬ì¹˜ìˆëŠ” í‘œí˜„ìœ¼ë¡œ ëª¨ë“  ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“œëŠ” ë§¤ë ¥ì ì¸ ë¶„ì´ì—ìš”.`,
                    informative: `${userName}ë‹˜ì€ ì²´ê³„ì ì´ê³  ìœ ìš©í•œ ì •ë³´ë¡œ ëª¨ë‘ì˜ ìƒí™œì„ í¸ë¦¬í•˜ê²Œ ë§Œë“œëŠ” ì •ë³´ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. í•„ìš”í•œ ì •ë³´ë¥¼ ì •í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ ì „ë‹¬í•˜ëŠ” ì†Œí†µì˜ í”„ë¡œí˜ì…”ë„ì´ì—ìš”.`,
                    gentle: `${userName}ë‹˜ì€ ë¶€ë“œëŸ½ê³  ë”°ëœ»í•œ ë§ í•œë§ˆë””ë¡œ ê¹Šì€ ê°ë™ì„ ì£¼ëŠ” ë§ˆìŒì˜ í„°ì¹˜ ë§ˆìŠ¤í„°ì…ë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê°•ë ¥í•œ ì˜í–¥ë ¥ìœ¼ë¡œ ëª¨ë“  ì´ì˜ ë§ˆìŒì— í‰ì•ˆì„ ì„ ì‚¬í•˜ëŠ” íŠ¹ë³„í•œ ë¶„ì´ì—ìš”.`,
                    mediator: `${userName}ë‹˜ì€ ê°ˆë“±ê³¼ ëŒ€ë¦½ì„ ì¡°í™”ë¡­ê²Œ í•´ê²°í•˜ëŠ” ê´€ê³„ ì¡°ì •ì˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ëª¨ë“  ì…ì¥ì„ ê³µì •í•˜ê²Œ ë°”ë¼ë³´ë©° í‰í™”ë¡œìš´ í•´ê²°ì±…ì„ ì°¾ì•„ë‚´ëŠ” ì™¸êµê´€ì  ì¬ëŠ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.`,
                    understanding: `${userName}ë‹˜ì€ ëª¨ë“  ì…ì¥ì„ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” ë›°ì–´ë‚œ ì •ì„œì  ì§€ëŠ¥ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. í¸ê²¬ ì—†ëŠ” ì—´ë¦° ë§ˆìŒìœ¼ë¡œ ëª¨ë“  ì´ì˜ ì´ì•¼ê¸°ë¥¼ ë”°ëœ»í•˜ê²Œ ë°›ì•„ë“¤ì´ëŠ” í¬ìš©ë ¥ì˜ ëŒ€ê°€ì˜ˆìš”.`,
                    peaceful: `${userName}ë‹˜ì€ ìì—°ìŠ¤ëŸ½ê²Œ í‰í™”ë¡œìš´ ë¶„ìœ„ê¸°ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” ì•ˆì •ê°ì˜ ì œê³µìì…ë‹ˆë‹¤. ë‚´ë©´ì˜ ê³ ìš”í•¨ê³¼ í‰ì˜¨í•¨ìœ¼ë¡œ ì£¼ë³€ ëª¨ë“  ì´ì˜ ë§ˆìŒì„ ì°¨ë¶„í•˜ê²Œ ë§Œë“œëŠ” íë§ì˜ ì¡´ì¬ì˜ˆìš”.`,
                    nurturing: `${userName}ë‹˜ì€ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ê³¼ ë°œì „ì„ ì„¸ì‹¬í•˜ê²Œ ëŒë³´ê³  í‚¤ì›Œì£¼ëŠ” ë§ˆìŒì˜ ì •ì›ì‚¬ì…ë‹ˆë‹¤. ì¸ë‚´ì‹¬ê³¼ ì‚¬ë‘ìœ¼ë¡œ ëª¨ë“  ì´ì˜ ì ì¬ë ¥ì´ ê½ƒí•„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì„±ì¥ì˜ ë™ë°˜ìì˜ˆìš”.`,
                    joyful: `${userName}ë‹˜ì€ ì£¼ë³€ ëª¨ë“  ì‚¬ëŒì—ê²Œ ê¸°ì¨ê³¼ ì¦ê±°ì›€ì„ ì „íŒŒí•˜ëŠ” í–‰ë³µì˜ ì „ë„ì‚¬ì…ë‹ˆë‹¤. ìˆœìˆ˜í•œ ê¸°ì¨ê³¼ ë°ì€ ì—ë„ˆì§€ë¡œ ëª¨ë“  ìˆœê°„ì„ ì¶•ì œì²˜ëŸ¼ ë§Œë“œëŠ” ê¸°ì¨ì˜ í™”ì‹ ì´ì—ìš”.`,
                    inspiring: `${userName}ë‹˜ì€ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì˜ê°ê³¼ ë™ê¸°ë¥¼ ë¶ˆëŸ¬ì¼ìœ¼í‚¤ëŠ” ì‚¶ì˜ ë©˜í† ì…ë‹ˆë‹¤. ìì‹ ì˜ ì‚¶ìœ¼ë¡œ ê°€ëŠ¥ì„±ì„ ì¦ëª…í•˜ë©° ëª¨ë“  ì´ì—ê²Œ í¬ë§ê³¼ ìš©ê¸°ë¥¼ ì„ ì‚¬í•˜ëŠ” ì˜ê°ì˜ ì›ì²œì´ì—ìš”.`,
                    trustworthy: `${userName}ë‹˜ì€ ì ˆëŒ€ì ì¸ ì‹ ë¢°ì™€ ë¯¿ìŒì„ ë°”íƒ•ìœ¼ë¡œ í•œ ê´€ê³„ì˜ ê¸°ë°˜ì„ ë§Œë“œëŠ” ì‚¬ëŒì…ë‹ˆë‹¤. ì¼ê´€ì„± ìˆëŠ” í–‰ë™ê³¼ ì§„ì‹¤í•œ ë§ˆìŒìœ¼ë¡œ ëª¨ë“  ì´ì—ê²Œ ì•ˆì „í•œ ê´€ê³„ì˜ ì•ˆì‹ì²˜ê°€ ë˜ì–´ì£¼ëŠ” ë¶„ì´ì—ìš”.`
                };
                
                const mainTrait = traits[0][0];
                return summaries[mainTrait] || `${userName}ë‹˜ì€ ë…íŠ¹í•˜ê³  íŠ¹ë³„í•œ ë§¤ë ¥ì„ ê°€ì§„ ì†Œì¤‘í•œ ë¶„ì…ë‹ˆë‹¤. ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ê¸ì •ì ì¸ ì˜í–¥ì„ ì£¼ë©°, í•¨ê»˜ ìˆìœ¼ë©´ ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ê²Œ ë§Œë“œëŠ” ì˜ê°ì„ ì£¼ëŠ” ì¡´ì¬ì˜ˆìš”.`;
            },

            getTraitMeaning: (trait, percentage) => {
                const meanings = {
                    empathetic: "íƒ€ì¸ì˜ ê°ì •ì— ê¹Šì´ ê³µê°í•˜ë©°, ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ì´í•´í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë¶„ì…ë‹ˆë‹¤.",
                    comforting: "ìì—°ìŠ¤ëŸ½ê³  ë”°ëœ»í•œ ìœ„ë¡œë¡œ ìƒì²˜ë°›ì€ ë§ˆìŒì„ ì¹˜ìœ í•˜ëŠ” íŠ¹ë³„í•œ ì¬ëŠ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    thoughtful: "ì‹ ì¤‘í•˜ê³  ê¹Šì´ ìˆëŠ” ì‚¬ê³ ë¡œ í˜„ëª…í•œ íŒë‹¨ì„ ë‚´ë¦¬ë©°, ì£¼ë³€ì„ ë°°ë ¤í•˜ëŠ” ë§ˆìŒì´ ê¹ŠìŠµë‹ˆë‹¤.",
                    healing: "ë¶„ìœ„ê¸°ë¥¼ ì½ê³  ìƒí™©ì— ë§ëŠ” ì™„ë²½í•œ ë¬´ë“œë¥¼ ì—°ì¶œí•˜ëŠ” ê°ì„±ì  ì§€ëŠ¥ì´ ë†’ì€ ë¶„ì…ë‹ˆë‹¤.",
                    organized: "ì²´ê³„ì ì´ê³  ì™„ë²½í•œ ê³„íšìœ¼ë¡œ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ë©°, ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ì•ˆì •ê°ì„ ì£¼ëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    creative: "ë…ì°½ì ì´ê³  í˜ì‹ ì ì¸ ì•„ì´ë””ì–´ë¡œ ìƒˆë¡œìš´ ê°€ì¹˜ë¥¼ ì°½ì¡°í•˜ëŠ” ì°½ì˜ì  ì‚¬ê³ ì˜ ì†Œìœ ìì…ë‹ˆë‹¤.",
                    harmonious: "ê°ˆë“±ì„ ì¡°í™”ë¡­ê²Œ í•´ê²°í•˜ê³  ëª¨ë“  ì‚¬ëŒì´ í•¨ê»˜í•  ìˆ˜ ìˆëŠ” ë¶„ìœ„ê¸°ë¥¼ ë§Œë“œëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.",
                    easygoing: "ì–´ë–¤ ìƒí™©ì—ë„ ìœ ì—°í•˜ê²Œ ì ì‘í•˜ë©°, ìì—°ìŠ¤ëŸ¬ìš´ ë§¤ë ¥ìœ¼ë¡œ ì£¼ë³€ì„ í¸ì•ˆí•˜ê²Œ ë§Œë“œëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    artistic: "ë¯¸ì  ê°ê°ê³¼ ì°½ì¡°ì  ëŠ¥ë ¥ìœ¼ë¡œ ì¼ìƒì— ì•„ë¦„ë‹¤ì›€ì„ ë”í•˜ëŠ” ì˜ˆìˆ ê°€ì  ì¬ëŠ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    social: "ì‚¬ëŒë“¤ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°í•˜ê³  ëª¨ìœ¼ëŠ” ë›°ì–´ë‚œ ì‚¬íšŒì  ëŠ¥ë ¥ê³¼ ì¹œí™”ë ¥ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤.",
                    attentive: "ìƒëŒ€ë°©ì˜ ì‘ì€ ë¶€ë¶„ê¹Œì§€ ì„¸ì‹¬í•˜ê²Œ ê´€ì°°í•˜ê³  ë°°ë ¤í•˜ëŠ” ì„¬ì„¸í•œ ë§ˆìŒì”¨ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    entertaining: "ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¡œ í‰ë²”í•œ ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“œëŠ” ì—”í„°í…Œì¸ë¨¼íŠ¸ ê°ê°ì´ ë›°ì–´ë‚œ ë¶„ì…ë‹ˆë‹¤.",
                    generous: "ìì‹ ì˜ ê²ƒì„ ì•„ë‚Œì—†ì´ ë‚˜ëˆ„ë©°, ë² í‘¸ëŠ” ì¼ì— ê¸°ì¨ì„ ëŠë¼ëŠ” ë„ˆê·¸ëŸ¬ìš´ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    practical: "í˜„ì‹¤ì ì´ê³  íš¨ìœ¨ì ì¸ í•´ê²°ì±…ì„ ì°¾ì•„ë‚´ëŠ” ë›°ì–´ë‚œ ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤.",
                    optimistic: "ì–´ë–¤ ìƒí™©ì—ì„œë„ ê¸ì •ì ì¸ ë©´ì„ ì°¾ì•„ë‚´ë©°, í¬ë§ê³¼ ìš©ê¸°ë¥¼ ìƒì§€ ì•ŠëŠ” ê°•í•œ ì •ì‹ ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    reliable: "ì•½ì†ê³¼ ì±…ì„ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë©°, ì¼ê´€ì„± ìˆëŠ” í–‰ë™ìœ¼ë¡œ ì‹ ë¢°ë¥¼ ìŒ“ì•„ê°€ëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    supportive: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ê³¼ ì„±ê³µì„ ì§„ì‹¬ìœ¼ë¡œ ì‘ì›í•˜ë©°, ë“ ë“ í•œ ì§€ì§€ë¥¼ ë³´ë‚´ëŠ” ë§ˆìŒì´ ë”°ëœ»í•œ ë¶„ì…ë‹ˆë‹¤.",
                    wise: "ê¹Šì€ ê²½í—˜ê³¼ ì„±ì°°ì„ ë°”íƒ•ìœ¼ë¡œ í˜„ëª…í•œ ì¡°ì–¸ê³¼ í†µì°°ë ¥ì„ ì œê³µí•˜ëŠ” ì§€í˜œë¡œìš´ ë¶„ì…ë‹ˆë‹¤.",
                    adventurous: "ìƒˆë¡œìš´ ë„ì „ì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šìœ¼ë©°, ë³€í™”ì™€ ëª¨í—˜ì„ ì¦ê¸°ëŠ” ìš©ê¸° ìˆëŠ” ë§ˆìŒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    helpful: "í•„ìš”í•œ ì •ë³´ì™€ ë„ì›€ì„ ì•„ë‚Œì—†ì´ ì œê³µí•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ì— ê¸°ì—¬í•˜ê³  ì‹¶ì–´í•˜ëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    cheerful: "ë°ê³  ìœ ì¾Œí•œ ì—ë„ˆì§€ë¡œ ì£¼ë³€ ë¶„ìœ„ê¸°ë¥¼ ì¦ê²ê²Œ ë§Œë“œëŠ” ì²œì„±ì ì¸ ë¶„ìœ„ê¸° ë©”ì´ì»¤ì…ë‹ˆë‹¤.",
                    positive: "ê¸ì •ì ì¸ ì‹œê°ìœ¼ë¡œ ì„¸ìƒì„ ë°”ë¼ë³´ë©°, ë°ì€ ì—ë„ˆì§€ë¥¼ ì „íŒŒí•˜ëŠ” í–‡ì‚´ ê°™ì€ ì¡´ì¬ì…ë‹ˆë‹¤.",
                    caring: "ë‹¤ë¥¸ ì‚¬ëŒì„ ì§„ì‹¬ìœ¼ë¡œ ëŒë³´ê³  ë°°ë ¤í•˜ëŠ” ì¼ì„ ìì—°ìŠ¤ëŸ½ê²Œ í•˜ëŠ” ë”°ëœ»í•œ ë§ˆìŒì˜ ì†Œìœ ìì…ë‹ˆë‹¤.",
                    philosophical: "ì‚¶ì˜ ê¹Šì€ ì˜ë¯¸ë¥¼ íƒêµ¬í•˜ë©°, ë³¸ì§ˆì  ê°€ì¹˜ë¥¼ ì¤‘ì‹œí•˜ëŠ” ì² í•™ì  ì‚¬ê³ ë¥¼ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤.",
                    devoted: "ì†Œì¤‘í•œ ì‚¬ëŒê³¼ ê°€ì¹˜ë¥¼ ìœ„í•´ í—Œì‹ í•˜ë©°, ì§„ì‹¤í•œ ë§ˆìŒìœ¼ë¡œ ê´€ê³„ë¥¼ ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    affectionate: "ê°ì •ì„ ë”°ëœ»í•˜ê²Œ í‘œí˜„í•˜ë©°, ì• ì • ì–´ë¦° ê´€ì‹¬ìœ¼ë¡œ ê´€ê³„ì˜ ê¹Šì´ë¥¼ ë”í•´ê°€ëŠ” ë¶„ì…ë‹ˆë‹¤.",
                    therapeutic: "ìì—°ìŠ¤ëŸ¬ìš´ ì¹˜ìœ ì˜ ëŠ¥ë ¥ìœ¼ë¡œ ìƒì²˜ë°›ì€ ë§ˆìŒì„ ëŒë³´ê³  ìœ„ë¡œí•´ì£¼ëŠ” íë§ì˜ ì¡´ì¬ì…ë‹ˆë‹¤.",
                    uplifting: "ê¸ì •ì ì¸ ì˜í–¥ë ¥ìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ëŒì˜ ê¸°ë¶„ê³¼ ì—ë„ˆì§€ë¥¼ ëŒì–´ì˜¬ë¦¬ëŠ” íŠ¹ë³„í•œ ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    responsive: "ì†Œí†µì— ì ê·¹ì ì´ë©°, ìƒëŒ€ë°©ì˜ ë§ì— ì§„ì‹¬ìœ¼ë¡œ ë°˜ì‘í•˜ê³  ê³µê°í•˜ëŠ” ëŒ€í™”ì˜ ë‹¬ì¸ì…ë‹ˆë‹¤.",
                    witty: "ì§€ì ì´ê³  ì¬ì¹˜ìˆëŠ” ìœ ë¨¸ë¡œ ëª¨ë“  ìƒí™©ì„ ì¦ê²ê²Œ ë§Œë“œëŠ” ì„¼ìŠ¤ì™€ ì¬ì¹˜ì˜ ì†Œìœ ìì…ë‹ˆë‹¤.",
                    informative: "ìœ ìš©í•˜ê³  ì •í™•í•œ ì •ë³´ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•˜ì—¬ ì „ë‹¬í•˜ëŠ” ì†Œí†µ ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë¶„ì…ë‹ˆë‹¤.",
                    gentle: "ë¶€ë“œëŸ½ê³  ë”°ëœ»í•œ ë§ˆìŒìœ¼ë¡œ ìƒëŒ€ë°©ì—ê²Œ ì•ˆì •ê°ê³¼ í‰ì•ˆí•¨ì„ ì„ ì‚¬í•˜ëŠ” ì˜¨í™”í•œ ì„±í’ˆì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    mediator: "ì„œë¡œ ë‹¤ë¥¸ ì˜ê²¬ì„ ì¡°ìœ¨í•˜ê³  ê°ˆë“±ì„ í‰í™”ë¡­ê²Œ í•´ê²°í•˜ëŠ” ë›°ì–´ë‚œ ì¤‘ì¬ ëŠ¥ë ¥ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤.",
                    understanding: "ë‹¤ì–‘í•œ ê´€ì ì„ ì´í•´í•˜ê³  ë°›ì•„ë“¤ì´ëŠ” ë„“ì€ í¬ìš©ë ¥ê³¼ ê³µê° ëŠ¥ë ¥ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤.",
                    peaceful: "ë‚´ë©´ì˜ í‰ì˜¨í•¨ìœ¼ë¡œ ì£¼ë³€ì— ì•ˆì •ê°ì„ ì£¼ë©°, ì¡°í™”ë¡œìš´ ë¶„ìœ„ê¸°ë¥¼ ë§Œë“œëŠ” í‰í™”ë¡œìš´ ì¡´ì¬ì…ë‹ˆë‹¤.",
                    nurturing: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ê³¼ ë°œì „ì„ ì„¸ì‹¬í•˜ê²Œ ë„ìš°ë©°, ì ì¬ë ¥ì„ í‚¤ì›Œì£¼ëŠ” ë”°ëœ»í•œ ëŒë´„ì˜ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    joyful: "ìˆœìˆ˜í•œ ê¸°ì¨ê³¼ ì¦ê±°ì›€ì„ ë‚˜ëˆ„ë©°, ì£¼ë³€ ëª¨ë“  ì´ì˜ í•˜ë£¨ë¥¼ ë°ê²Œ ë§Œë“œëŠ” í–‰ë³µì˜ ì „ë ¹ì…ë‹ˆë‹¤.",
                    inspiring: "ìì‹ ì˜ ì‚¶ê³¼ í–‰ë™ìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì˜ê°ê³¼ ë™ê¸°ë¥¼ ì£¼ëŠ” ì‚¶ì˜ ë©˜í† ì´ì ë¡¤ëª¨ë¸ì…ë‹ˆë‹¤.",
                    trustworthy: "ì§„ì‹¤í•˜ê³  ì¼ê´€ëœ í–‰ë™ìœ¼ë¡œ ì ˆëŒ€ì ì¸ ì‹ ë¢°ë¥¼ ìŒ“ì•„ê°€ë©°, ê´€ê³„ì˜ ë“ ë“ í•œ ê¸°ë°˜ì´ ë˜ëŠ” ë¶„ì…ë‹ˆë‹¤."
                };
                
                return meanings[trait] || "ë…íŠ¹í•˜ê³  ë§¤ë ¥ì ì¸ ì„±í–¥ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ê¸ì •ì ì¸ ì˜í–¥ì„ ì£¼ëŠ” ë¶„ì…ë‹ˆë‹¤.";
            },

            generateClosingMessage: (userName, count) => {
                return `${count}ëª…ì˜ ì†Œì¤‘í•œ ë¶„ë“¤ì´ ${userName}ë‹˜ì— ëŒ€í•´ ì „í•´ì¤€ ì´ì•¼ê¸°ëŠ” ë‹¨ìˆœí•œ í‰ê°€ê°€ ì•„ë‹Œ, 
                        ì§„ì‹¬ì–´ë¦° ë§ˆìŒì˜ ì„ ë¬¼ì…ë‹ˆë‹¤. ì´ ê²°ê³¼ê°€ ${userName}ë‹˜ê»˜ ì‘ì€ ìœ„ë¡œì™€ í° í˜ì´ ë˜ê¸°ë¥¼ ë°”ë¼ë©°, 
                        ì•ìœ¼ë¡œë„ ì§€ê¸ˆì²˜ëŸ¼ ì•„ë¦„ë‹¤ìš´ ë§ˆìŒìœ¼ë¡œ ì„¸ìƒì„ ë°í˜€ì£¼ì‹œê¸¸ ì‘ì›í•©ë‹ˆë‹¤. 
                        ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ íŠ¹ë³„í•˜ê³  ì†Œì¤‘í•œ ì¡´ì¬ì…ë‹ˆë‹¤.`;
            },

            getEmptyResultHTML: () => {
                return `
                    <div class="encouragement-card">
                        <h3 style="margin-bottom: 1rem; color: #667eea;">ì•„ì§ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”</h3>
                        <p>
                            ì†Œì¤‘í•œ ì¹œêµ¬ë“¤ì˜ ë§ˆìŒì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.<br>
                            ë§í¬ë¥¼ ë” ë§ì´ ê³µìœ í•´ì„œ<br>
                            ë”°ëœ»í•œ ì‹œì„ ë“¤ì„ ëª¨ì•„ë³´ì„¸ìš”.
                        </p>
                    </div>
                `;
            },

            setupSharing: (userName) => {
                // URL ìƒì„± (í˜„ì¬ í˜ì´ì§€ + ì‚¬ìš©ì íŒŒë¼ë¯¸í„°)
                const currentUrl = window.location.origin + window.location.pathname;
                const shareUrl = `${currentUrl}?user=${encodeURIComponent(userName)}`;
                const ownerUrl = `${currentUrl}?view=results&user=${encodeURIComponent(userName)}`;
                
                // ë§í¬ ìš”ì†Œ ì°¾ê¸° ë° ì„¤ì •
                const shareLinkElement = document.getElementById('shareLink');
                const ownerLinkElement = document.getElementById('ownerLink');
                
                if (shareLinkElement) {
                    shareLinkElement.textContent = shareUrl;
                }
                
                if (ownerLinkElement) {
                    ownerLinkElement.textContent = ownerUrl;
                    ownerLinkElement.addEventListener('click', async () => {
                        const success = await Utils.copyToClipboard(ownerUrl);
                        if (success) {
                            Utils.showNotification('ë‹¹ì‚¬ì ì „ìš© ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì–¸ì œë“  ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.');
                        }
                    });
                }
                
                // ë§í¬ê°€ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
                if (!shareLinkElement) {
                    // ìš”ì†Œê°€ ì—†ìœ¼ë©´ ë‹¤ì‹œ ì‹œë„
                    setTimeout(() => {
                        const retryElement = document.getElementById('shareLink');
                        const retryOwnerElement = document.getElementById('ownerLink');
                        if (retryElement) {
                            retryElement.textContent = shareUrl;
                        }
                        if (retryOwnerElement) {
                            retryOwnerElement.textContent = ownerUrl;
                        }
                    }, 200);
                }
            }
        };

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        const setupEventListeners = () => {
            // ì„¤ë¬¸ ìƒì„± í¼
            document.getElementById('setupForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const userName = document.getElementById('userName').value.trim();
                
                if (!userName) {
                    Utils.showNotification('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜Š');
                    return;
                }
                
                console.log('ì„¤ë¬¸ ìƒì„± - ì‚¬ìš©ìëª…:', userName); // ë””ë²„ê¹…
                
                const surveyId = Utils.generateSurveyId(userName);
                AppState.surveys[surveyId] = {
                    name: userName,
                    responses: [],
                    traits: {},
                    createdAt: new Date().toISOString()
                };
                
                // ì‚¬ìš©ìëª…ì„ ì „ì—­ì— ì €ì¥ (ë§í¬ ìƒì„±ìš©)
                AppState.currentUserName = userName;
                
                // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ê³  ê²°ê³¼ í™”ë©´ í‘œì‹œ (DOM ì•ˆì •í™”)
                setTimeout(() => {
                    ScreenManager.showResults(surveyId, userName);
                }, 100);
            });

            // ì¹´ì¹´ì˜¤í†¡ ê³µìœ 
            document.getElementById('kakaoShareBtn').addEventListener('click', async () => {
                const userNameElement = document.querySelector('#resultStats .stat-label');
                const userName = userNameElement ? userNameElement.textContent : (AppState.currentUserName || 'ìµëª…');
                
                let linkElement = document.getElementById('shareLink');
                let link = linkElement ? linkElement.textContent : '';
                
                // ë§í¬ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì§ì ‘ ìƒì„±
                if (!link && AppState.currentUserName) {
                    const currentUrl = window.location.origin + window.location.pathname;
                    link = `${currentUrl}?user=${encodeURIComponent(AppState.currentUserName)}`;
                    
                    // ë§í¬ ìš”ì†Œì—ë„ ì—…ë°ì´íŠ¸
                    if (linkElement) {
                        linkElement.textContent = link;
                    }
                }
                
                if (!link) {
                    Utils.showNotification('âš ï¸ ë§í¬ê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!');
                    return;
                }
                
                const shareText = `ğŸŒ» ë™ë£Œë“¤ì´ ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµ í…ŒìŠ¤íŠ¸

${userName}ë‹˜ì´ ë™ë£Œë“¤ì˜ ì‹œì„ ì—ì„œ ë°œê²¬í•˜ê³  ì‹¶ì–´í•´ìš”!

í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ë°”ë¡œ ì°¸ì—¬ ê°€ëŠ¥ ğŸˆ
ë”°ëœ»í•œ ì‹œì„ ìœ¼ë¡œ ì‘ì›í•´ì£¼ì„¸ìš”~

${link}

#ë™ë£Œí…ŒìŠ¤íŠ¸ #íšŒì‚¬ìƒí™œ #ì§ì¥ì¸ #íŒ€ì›Œí¬`;

                if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                    if (navigator.share) {
                        navigator.share({
                            title: 'ë™ë£Œë“¤ì´ ë³´ëŠ” ë‚˜ì˜ ì§„ì§œ ëª¨ìŠµ',
                            text: shareText
                        });
                    } else {
                        const success = await Utils.copyToClipboard(shareText);
                        if (success) {
                            Utils.showNotification('ğŸˆ ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆì–´ìš”!\n\nì¹´í†¡ì— ë¶™ì—¬ë„£ê¸° í•´ì„œ ì¹œêµ¬ë“¤ì—ê²Œ ë³´ë‚´ì£¼ì„¸ìš”! ğŸŒ»');
                        } else {
                            Utils.showNotification('ğŸˆ ê³µìœ í•˜ê¸°ë¥¼ ìœ„í•´ ë§í¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!\n\nCtrl+Cë¡œ ë³µì‚¬í•´ì„œ ì¹´í†¡ì— ë³´ë‚´ì£¼ì„¸ìš”! ğŸŒ»');
                        }
                    }
                } else {
                    const success = await Utils.copyToClipboard(shareText);
                    if (success) {
                        Utils.showNotification('ğŸˆ ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆì–´ìš”!\n\nì¹´í†¡ì— ë¶™ì—¬ë„£ê¸° í•´ì„œ ì¹œêµ¬ë“¤ì—ê²Œ ë³´ë‚´ì£¼ì„¸ìš”! ğŸŒ»');
                    } else {
                        Utils.showNotification('ğŸˆ ê³µìœ í•˜ê¸°ë¥¼ ìœ„í•´ ë§í¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!\n\nCtrl+Cë¡œ ë³µì‚¬í•´ì„œ ì¹´í†¡ì— ë³´ë‚´ì£¼ì„¸ìš”! ğŸŒ»');
                    }
                }
            });

            // ë§í¬ ë³µì‚¬
            document.getElementById('copyLinkBtn').addEventListener('click', async () => {
                let linkElement = document.getElementById('shareLink');
                let link = linkElement ? linkElement.textContent : '';
                
                // ë§í¬ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì§ì ‘ ìƒì„±
                if (!link && AppState.currentUserName) {
                    const currentUrl = window.location.origin + window.location.pathname;
                    link = `${currentUrl}?user=${encodeURIComponent(AppState.currentUserName)}`;
                    
                    if (linkElement) {
                        linkElement.textContent = link;
                    }
                }
                
                if (!link) {
                    Utils.showNotification('ë§í¬ê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
                    return;
                }
                
                const success = await Utils.copyToClipboard(link);
                
                if (success) {
                    Utils.showNotification(
                        'ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n' +
                        'ì¹´í†¡, ë©”ì‹ ì €, ì´ë©”ì¼ ì–´ë””ë“  ë³´ë‚´ì£¼ì„¸ìš”.\n' +
                        'ì¹œêµ¬ë“¤ì´ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ë°”ë¡œ ì°¸ì—¬í•  ìˆ˜ ìˆì–´ìš”.\n\n' +
                        'ë¶„ëª… ë”°ëœ»í•œ ì‘ì›ì„ ë§ì´ ë°›ìœ¼ì‹¤ ê±°ì˜ˆìš”.'
                    );
                } else {
                    if (linkElement) {
                        const range = document.createRange();
                        range.selectNode(linkElement);
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                    }
                    
                    Utils.showNotification(
                        'ë§í¬ê°€ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.\n\n' +
                        'Ctrl+C (ë˜ëŠ” Cmd+C)ë¥¼ ëˆŒëŸ¬ì„œ ë³µì‚¬í•´ì£¼ì„¸ìš”.\n' +
                        'ê·¸ë¦¬ê³  ì¹œêµ¬ë“¤ì—ê²Œ ê³µìœ í•´ë³´ì„¸ìš”.'
                    );
                }
            });

            // ì„¤ë¬¸ ì™„ë£Œ í™”ë©´ ì´ë²¤íŠ¸ë“¤
            document.getElementById('viewResultsBtn').addEventListener('click', () => {
                const surveyId = AppState.currentUser;
                const survey = AppState.surveys[surveyId];
                if (survey) {
                    ScreenManager.showResults(surveyId, survey.name);
                }
            });

            document.getElementById('createMyLinkBtn').addEventListener('click', () => {
                const newUserName = document.getElementById('newUserName').value.trim();
                
                if (!newUserName) {
                    Utils.showNotification('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const surveyId = Utils.generateSurveyId(newUserName);
                AppState.surveys[surveyId] = {
                    name: newUserName,
                    responses: [],
                    traits: {},
                    createdAt: new Date().toISOString()
                };
                AppState.currentUserName = newUserName;
                
                ScreenManager.showResults(surveyId, newUserName);
            });

            document.getElementById('restartBtn').addEventListener('click', () => {
                if (confirm('ìƒˆë¡œìš´ ì¹œêµ¬ë¥¼ í‰ê°€í•˜ì‹œê² ì–´ìš”?')) {
                    window.history.replaceState({}, document.title, window.location.pathname);
                    location.reload();
                }
            });

            // ìƒˆ ì„¤ë¬¸ ë§Œë“¤ê¸°
            document.getElementById('newSurveyBtn').addEventListener('click', () => {
                if (confirm('ìƒˆë¡œìš´ ì„¤ë¬¸ì„ ë§Œë“œì‹œê² ì–´ìš”?')) {
                    window.history.replaceState({}, document.title, window.location.pathname);
                    location.reload();
                }
            });

            // ë§í¬ ì˜ì—­ í´ë¦­ìœ¼ë¡œë„ ë³µì‚¬ ê°€ëŠ¥
            document.addEventListener('click', async (e) => {
                if (e.target.id === 'shareLink') {
                    let link = e.target.textContent;
                    
                    if (!link && AppState.currentUserName) {
                        const currentUrl = window.location.origin + window.location.pathname;
                        link = `${currentUrl}?user=${encodeURIComponent(AppState.currentUserName)}`;
                        e.target.textContent = link;
                    }
                    
                    if (!link) {
                        Utils.showNotification('ë§í¬ê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    const success = await Utils.copyToClipboard(link);
                    
                    if (success) {
                        Utils.showNotification('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else {
                        Utils.showNotification('Ctrl+Cë¥¼ ëˆŒëŸ¬ì„œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                    }
                }
            });

            // í˜ì´ì§€ ì´íƒˆ ë°©ì§€
            window.addEventListener('beforeunload', (e) => {
                if (AppState.currentUser && AppState.currentQuestionIndex > 0 && AppState.currentQuestionIndex < QUESTIONS.length) {
                    e.preventDefault();
                    e.returnValue = 'ì„¤ë¬¸ì´ ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì •ë§ ë‚˜ê°€ì‹œê² ì–´ìš”?';
                }
            });
        };

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” (ì•ˆì „ì„± ë° ì„±ëŠ¥ ìµœì í™”)
        const initializeApp = () => {
            try {
                if (AppState.initialized) {
                    console.warn('ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ë¯¸ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    return;
                }

                const urlParams = new URLSearchParams(window.location.search);
                const userName = urlParams.get('user');
                const viewType = urlParams.get('view');
                
                if (userName && viewType === 'results') {
                    // ë‹¹ì‚¬ìê°€ ê²°ê³¼ë¥¼ ë³´ë ¤ëŠ” ê²½ìš°
                    try {
                        const decodedUserName = decodeURIComponent(userName);
                        if (decodedUserName && decodedUserName.length <= 50) {
                            ScreenManager.viewResults(decodedUserName);
                        } else {
                            console.error('ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëª…:', decodedUserName);
                            ScreenManager.showSetup();
                        }
                    } catch (error) {
                        console.error('ì‚¬ìš©ìëª… ë””ì½”ë”© ì˜¤ë¥˜:', error);
                        ScreenManager.showSetup();
                    }
                } else if (userName) {
                    // ì„¤ë¬¸ ì°¸ì—¬ ëª¨ë“œ
                    try {
                        const decodedUserName = decodeURIComponent(userName);
                        if (decodedUserName && decodedUserName.length <= 50) {
                            ScreenManager.showSurvey(decodedUserName);
                        } else {
                            console.error('ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëª…:', decodedUserName);
                            ScreenManager.showSetup();
                        }
                    } catch (error) {
                        console.error('ì„¤ë¬¸ ì°¸ì—¬ ëª¨ë“œ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                        ScreenManager.showSetup();
                    }
                } else {
                    // ì„¤ë¬¸ ìƒì„± ëª¨ë“œ
                    ScreenManager.showSetup();
                }

                AppState.initialized = true;
                
                // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (ê°œë°œ ëª¨ë“œì—ì„œë§Œ)
                if (typeof performance !== 'undefined' && performance.mark) {
                    performance.mark('app-initialized');
                }

            } catch (error) {
                console.error('ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                Utils.showNotification('ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì´ˆê¸°í™”í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                // í´ë°±ìœ¼ë¡œ ì„¤ì • í™”ë©´ í‘œì‹œ
                try {
                    ScreenManager.showSetup();
                } catch (fallbackError) {
                    console.error('í´ë°± ì´ˆê¸°í™”ë„ ì‹¤íŒ¨:', fallbackError);
                }
            }
        };

        // DOM ë¡œë“œ ì‹œ ì‹¤í–‰ (ìµœì í™”ëœ ì´ˆê¸°í™”)
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë¨¼ì € ì„¤ì •
                setupEventListeners();
                
                // ê·¸ ë‹¤ìŒ ì•± ì´ˆê¸°í™”
                initializeApp();
                
                // í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì²˜ë¦¬ (ì„±ëŠ¥ ìµœì í™”)
                if ('visibilityState' in document) {
                    document.addEventListener('visibilitychange', () => {
                        if (document.visibilityState === 'visible') {
                            // í˜ì´ì§€ê°€ ë‹¤ì‹œ ë³´ì¼ ë•Œ ìƒíƒœ ë³µêµ¬
                            console.log('í˜ì´ì§€ê°€ ë‹¤ì‹œ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        }
                    }, { passive: true });
                }

                // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ (PWA ì§€ì› - ì„ íƒì )
                if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
                    navigator.serviceWorker.register('/sw.js').catch(error => {
                        console.log('Service Worker ë“±ë¡ ì‹¤íŒ¨:', error);
                    });
                }

            } catch (error) {
                console.error('DOM ë¡œë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                Utils.showNotification('í˜ì´ì§€ ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ìœˆë„ìš° ì–¸ë¡œë“œ ì‹œ ì •ë¦¬ ì‘ì—…
        window.addEventListener('unload', () => {
            Utils.cleanup();
        }, { passive: true });

        // ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
        window.addEventListener('error', (event) => {
            console.error('ì „ì—­ ì—ëŸ¬ ë°œìƒ:', event.error);
            // ì‚¬ìš©ìì—ê²ŒëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ (ë¡œê·¸ë§Œ ê¸°ë¡)
        }, { passive: true });

        // Promise ê±°ë¶€ í•¸ë“¤ëŸ¬
        window.addEventListener('unhandledrejection', (event) => {
            console.error('ì²˜ë¦¬ë˜ì§€ ì•Šì€ Promise ê±°ë¶€:', event.reason);
            event.preventDefault(); // ì½˜ì†” ì—ëŸ¬ ë°©ì§€
        }, { passive: true });
    </script>
</body>
</html>
